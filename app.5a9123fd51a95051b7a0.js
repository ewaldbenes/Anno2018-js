(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+7RP":function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TILE_HEIGHT=t.TILE_WIDTH=void 0;var i=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};t.TILE_WIDTH=64;t.TILE_HEIGHT=31;var a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.world=t,this.fs=n,this.spriteLoader=r}var t,n,a;return t=e,(n=[{key:"render",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spriteLoader.getIslandSprites(e);case 2:n=t.sent,console.log("Map sprites loaded."),n.sort(function(e,t){if(e.layer===t.layer){var n=e.position.x+e.position.y,r=t.position.x+t.position.y;return n===r?0:n<r?-1:1}return"land"===e.layer?-1:1}),console.log("Map sprites sorted."),n.forEach(function(e){return r.world.addChild(e.sprite)}),console.log("Map sprites drawn.");case 8:case"end":return t.stop()}},t,this)}))}}])&&r(t.prototype,n),a&&r(t,a),e}();t.default=a},"+NJT":function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a(this,o(t).apply(this,arguments))).dragging=!1,e}var n,r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,PIXI.Sprite),n=t,(r=[{key:"setSliderData",value:function(e,t,n){var r=this;this.position.set(this.position.x,this.position.y+(e-n)/2),this.topY=this.position.y,this.on("mousedown",function(e){r.dragging=!0}),this.on("mouseup",function(e){r.dragging=!1}),this.on("mousemove",function(e){if(r.dragging){var t=e.data.originalEvent.offsetY-r.texture.height/2;r.position.y=r.clamp(t,r.topY,r.topY+n-r.texture.height/2)}})}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(t,e),n)}}])&&i(n.prototype,r),u&&i(n,u),t}();t.default=u},"/7QA":function(e,t,n){"use strict";var r=x(n("XH0y"));n("qVmS");var i=x(n("kSzJ")),a=w(n("466s")),o=w(n("P9xW")),s=w(n("kBLC")),u=w(n("2bhA")),c=w(n("Uaxg")),l=w(n("+7RP")),d=w(n("2yww")),f=w(n("Y+Un")),h=w(n("5+n8")),p=w(n("LCUA")),m=w(n("q6wZ")),v=w(n("oroG")),g=n("a/P+"),y=w(n("2ZWV")),b=n("vurl");function w(e){return e&&e.__esModule?e:{default:e}}function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var k=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},S=n("UFs8");k(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,w,x,_,O,P,I,E,R,A,j,T,C,M,G,N,F,D,B,L=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.enableAll(),(t=document.createElement("style")).innerText="\n        body, html {\n            margin: 0;\n        }\n    ",(n=document.createElement("div")).id="game",(w=document.createElement("p")).innerHTML="Anno 2018, version ".concat("3f8d335",',\n                         made by <a href="https://github.com/cmfcmf">@cmfcmf</a>.\n                         The sourcecode can be found at <a href="https://github.com/cmfcmf/Anno2018-js">GitHub</a>.'),document.head.appendChild(t),document.body.appendChild(n),document.body.appendChild(w),x=new a.default,_=2e3,e.next=14,x.init(1048576*_);case 14:return window.fs=x,O=new y.default(x),e.next=18,O.init();case 18:return O.render(n),e.next=21,O.isUploaded();case 21:if(e.sent){e.next=24;break}return console.warn("Anno 1602 files not yet uploaded."),e.abrupt("return");case 24:return P=new i.Application({width:window.innerWidth,height:window.innerHeight-120,antialias:!1,transparent:!1}),n.insertAdjacentElement("afterbegin",P.view),I=new S({screenWidth:P.screen.width,screenHeight:P.screen.height}),P.stage.addChild(I),I.drag({direction:"all",wheel:!1}).wheel(),E=new S({screenWidth:P.screen.width,screenHeight:P.screen.height,worldWidth:1024,worldHeight:768}),P.stage.addChild(E),e.next=33,(0,g.loadTranslations)(x);case 33:return R=new u.default(x),e.next=36,R.load();case 36:return A=new s.default(x),e.next=39,A.load();case 39:return j=new h.default(x),e.next=42,j.load();case 42:if(T=new v.default(x),C=new p.default(new m.default(x)),M=new d.default(x,A,T),G=new l.default(I,x,M),N=new o.default(x,C,G,I,A,j),null===(F=(0,b.getQueryParameter)("load"))){e.next=54;break}return e.next=51,N.loadByName(F);case 51:E.visible=!1,e.next=59;break;case 54:return D=new c.default(E,T),(B=new f.default(x,D,j)).on("load-game",function(e){return k(L,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.load(e);case 2:E.visible=!1;case 3:case"end":return t.stop()}},t,this)}))}),e.next=59,B.renderScreen("menu_main");case 59:case"end":return e.stop()}},e,this)}))},"/dzE":function(module,exports,__webpack_require__){"use strict";(function(__dirname){Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFFmpeg=loadFFmpeg;var __awaiter=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},loadedFFmpeg;function loadFFmpeg(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!loadedFFmpeg){e.next=2;break}return e.abrupt("return",loadedFFmpeg);case 2:return e.next=4,doLoadFFmpeg();case 4:return loadedFFmpeg=e.sent,e.next=7,new Promise(function(e,t){loadedFFmpeg({arguments:["-version"],returnCallback:e})});case 7:return e.abrupt("return",loadedFFmpeg);case 8:case"end":return e.stop()}},e,this)}))}function doLoadFFmpeg(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function _callee2(){var ffmpeg;return regeneratorRuntime.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(console.log("Loading FFmpeg"),"undefined"==typeof window){_context2.next=7;break}return _context2.next=4,loadFFmpegInBrowser();case 4:ffmpeg=_context2.sent,_context2.next=8;break;case 7:ffmpeg=eval("require")(__dirname+"/../../node_modules/smk2mp4/demo/ffmpeg.js");case 8:return console.log("Finished loading FFmpeg"),_context2.abrupt("return",ffmpeg);case 10:case"end":return _context2.stop()}},_callee2,this)}))}function loadFFmpegInBrowser(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){var n=function(){var n=self.ffmpeg_run;n?e(n):t("Could not load FFmpeg!")},r=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src="ffmpeg.js",i.onreadystatechange=n,i.onload=n,r.appendChild(i)}));case 1:case"end":return e.stop()}},e,this)}))}}).call(this,"/")},0:function(e,t){},"0BjB":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=n("EeBo"),a=(r=n("lXCB"))&&r.__esModule?r:{default:r},o=n("PWAz");function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.islandLoader=t}var t,n,r;return t=e,(n=[{key:"populateWorld",value:function(e,t){return c(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,u,c,l,d,f,h,p,m,v,g,y,b,w,x;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=Math.max.apply(Math,s(e.islands.map(function(e){return e.id})))+1,u=!0,c=!1,l=void 0,n.prev=4,d=t.islandTemplates[Symbol.iterator]();case 6:if(u=(f=d.next()).done){n.next=37;break}return h=f.value,n.next=10,this.islandLoader.loadRandomIslandFile(h.size,h.climate);case 10:for(p=n.sent,m=p.data,v=p.isSouth,g=p.id,y=[];!m.eof();)y.push(o.Block.fromStream(m));b=y.find(function(e){return["INSEL5","INSEL4","INSEL3"].includes(e.type)}),(0,a.default)(void 0!==b),w=y.find(function(e){return"INSELHAUS"===e.type}),(0,a.default)(void 0!==w),x=void 0,n.t0=b.type,n.next="INSEL5"===n.t0?24:"INSEL4"===n.t0?26:"INSEL3"===n.t0?28:30;break;case 24:return x=(0,i.islandFromIsland5File)(r++,h.position,v,g,b.data),n.abrupt("break",31);case 26:return x=(0,i.islandFromIsland4File)(r++,h.position,v,g,b.data),n.abrupt("break",31);case 28:return x=(0,i.islandFromIsland3File)(r++,h.position,v,g,b.data),n.abrupt("break",31);case 30:throw new Error("This code cannot be reached.");case 31:x.baseFields=this.islandLoader.parseIslandBuildings(x,w),x.topFields=this.islandLoader.parseIslandBuildings(x,o.Block.empty("INSELHAUS")),e.islands.push(x);case 34:u=!0,n.next=6;break;case 37:n.next=43;break;case 39:n.prev=39,n.t1=n.catch(4),c=!0,l=n.t1;case 43:n.prev=43,n.prev=44,u||null==d.return||d.return();case 46:if(n.prev=46,!c){n.next=49;break}throw l;case 49:return n.finish(46);case 50:return n.finish(43);case 51:case"end":return n.stop()}},n,this,[[4,39,43,51],[44,,46,50]])}))}}])&&u(t.prototype,n),r&&u(t,r),e}();t.default=l},1:function(e,t){},2:function(e,t){},"2ZWV":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=y(n("fDnD")),i=y(n("XH0y")),a=y(n("q1tI")),o=y(n("i8i4")),s=g(n("IuTw")),u=g(n("daKf")),c=g(n("DfYP")),l=g(n("gn45")),d=g(n("cE7O")),f=g(n("tyYu")),h=g(n("T7bp")),p=g(n("ynKt")),m=g(n("96T+")),v=n("vurl");function g(e){return e&&e.__esModule?e:{default:e}}function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},x=n("oxjq"),k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.logger=i}var t,n,g;return t=e,(n=[{key:"init",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=console,e.next=3,this.fs.ls("/");case 3:e.t1=e.sent,e.t0.table.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(e){var t=this,n=document.createElement("div");o.render(a.createElement(m.default,{onUploaded:this.uploadAndParse.bind(this),onReset:this.reset.bind(this),onSaveOrMissionUploaded:function(e){return w(t,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.target.files)&&0!==n.length){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,Promise.all(Array.from(n).map(function(e){return r.uploadSaveOrMission(e)}));case 5:alert("Upload finished. The page will now refresh."),window.location.reload(!0);case 7:case"end":return t.stop()}},t,this)}))},setLogger:this.setLogger.bind(this)}),e),e.appendChild(n)}},{key:"isUploaded",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fs.exists("/fields.dat"));case 1:case"end":return e.stop()}},e,this)}))}},{key:"setLogger",value:function(e){this.logger=e}},{key:"reset",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fs.rmRoot();case 2:case"end":return e.stop()}},e,this)}))}},{key:"uploadAndParse",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.fs.write("/original.zip",e);case 3:return t.next=5,this.fs.open("/original.zip");case 5:return i=t.sent,t.next=8,r.loadAsync(i);case 8:n=t.sent,t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(0),this.logger.error("Could not upload the ZIP file: ".concat(t.t0.message)),t.abrupt("return",!1);case 15:return t.prev=15,a=(0,v.findRootInZip)(n),t.next=19,this.fs.rmRoot();case 19:return t.next=21,this.copyIslands(a);case 21:return t.next=23,this.copySaves(a);case 23:return t.next=25,this.parseTranslations(a);case 25:return o=t.sent,t.next=28,this.copyMissions(a,o);case 28:return t.next=30,this.decryptCODs(a);case 30:return t.next=32,this.parseDATs();case 32:return t.next=34,this.parseGADs(a);case 34:return t.next=36,this.parseBSHs(a);case 36:return t.next=38,this.parseZEIs(a);case 38:return t.next=40,this.parseMusic(a);case 40:return t.next=42,this.parseVideos(a);case 42:t.next=48;break;case 44:return t.prev=44,t.t1=t.catch(15),this.logger.error(t.t1.message),t.abrupt("return",!1);case 48:return t.abrupt("return",!0);case 49:case"end":return t.stop()}},t,this,[[0,11],[15,44]])}))}},{key:"uploadSaveOrMission",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.name.endsWith(".gam")){t.next=5;break}return t.next=3,this.fs.write("/saves/".concat(e.name),e);case 3:t.next=7;break;case 5:return t.next=7,this.fs.write("/missions-custom/".concat(e.name),e);case 7:case"end":return t.stop()}},t,this)}))}},{key:"parseDATs",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([["/fields.dat","/fields.json"],["/animations.dat","/animations.json"]].map(function(e){return w(t,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e[0],r=e[1],this.logger.info('Started parsing "'.concat(n,'".')),i=new c.default,t.t0=i,t.next=7,this.fs.openAndGetContentAsText(n);case 7:return t.t1=t.sent,a=t.t0.parse.call(t.t0,t.t1),t.next=11,this.fs.write(r,JSON.stringify(a));case 11:this.logger.info('Finished parsing "'.concat(n,'".'));case 12:case"end":return t.stop()}},t,this)}))})));case 1:case"end":return e.stop()}},e,this)}))}},{key:"parseGADs",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.mkdir("/screens");case 2:n=[["Anno.gad",""],["BASE.GAD","menu_main"],["BAU.GAD",""],["BAUKONT.GAD",""],["BAUSHIP.GAD",""],["BERGWERK.GAD",""],["BUBBLE01.GAD",""],["BUBBLE.GAD",""],["CHAT.GAD",""],["CLIENT.GAD",""],["CTRL.GAD",""],["DISK.GAD",""],["ENDE.GAD","menu_points"],["FARBWAHL.GAD","menu_player_selection"],["HANDEL.GAD",""],["HOST.GAD","menu_missions"],["INFO.GAD",""],["INFRA.GAD",""],["KONTOR.GAD",""],["LAGER.GAD",""],["LEIST.GAD",""],["MARKT.GAD",""],["MILITAR.GAD",""],["MISSION.GAD","menu_mission_details"],["MISSZIEL.GAD",""],["MKSHIP.GAD",""],["MKSOLDAT.GAD",""],["MUSIK.GAD",""],["OPTION.GAD",""],["PIRAT.GAD",""],["PIRATORD.GAD",""],["PLANTAGE.GAD",""],["PROD.GAD",""],["ROUTE.GAD",""],["SCAPE.GAD",""],["SHIP.GAD",""],["SHIPLIST.GAD",""],["SIEDLER.GAD",""],["SKSHIP.GAD",""],["SKSOLDAT.GAD",""],["STADT.GAD",""],["STADTLST.GAD",""],["TOOLS.INC",""],["TRADE.GAD",""],["TRADER.GAD",""],["TRANSFER.GAD",""],["TRIBUT.GAD",""],["TUTOR.GAD",""],["VERTRAG.GAD",""],["WAITLOAD.GAD","menu_loading"],["WERFT.GAD",""]],r=0;case 4:if(!(r<n.length)){t.next=23;break}return""===(i=n[r])[1]&&(i[1]=i[0]),a="GADDATA/".concat(i[0]),o="/screens/".concat(i[1],".json"),this.logger.info('Started parsing "'.concat(a,'".')),s=new c.default,u=this.findFileCaseInsensitive(e,a),t.t0=s,t.next=15,u.async("text");case 15:return t.t1=t.sent,l=t.t0.parse.call(t.t0,t.t1),t.next=19,this.fs.write(o,JSON.stringify(l));case 19:this.logger.info('Finished parsing "'.concat(a,'".'));case 20:r++,t.next=4;break;case 23:case"end":return t.stop()}},t,this)}))}},{key:"decryptCODs",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new u.default,t.abrupt("return",Promise.all([["haeuser.cod","/fields.dat"],["figuren.cod","/animations.dat"]].map(function(t){return w(r,void 0,void 0,regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t[0],a=t[1],this.logger.info('Started parsing "'.concat(i,'".')),o=this.findFileCaseInsensitive(e,i),r.next=6,d.default.fromZipObject(o);case 6:return s=r.sent,r.next=9,this.fs.write(a,n.decrypt(s));case 9:this.logger.info('Finished parsing "'.concat(i,'".'));case 10:case"end":return r.stop()}},r,this)}))})));case 2:case"end":return t.stop()}},t,this)}))}},{key:"parseBSHs",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,u,c,l,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=new s.default,r=[["GFX/NUMBERS","NUMBERS"],["GFX/STADTFLD","STADTFLD"],["GFX/EFFEKTE","EFFEKT"],["GFX/FISCHE","WAL"],["GFX/GAUKLER","GAUKLER"],["GFX/MAEHER","MAEHER"],["GFX/SCHATTEN","SCHATTEN"],["GFX/SHIP","SHIP"],["GFX/SOLDAT","SOLDAT"],["GFX/TIERE","RIND"],["GFX/TRAEGER","TRAEGER"],["ToolGfx/BAUHAUS","TOOLS/BAUHAUS"],["ToolGfx/BAUSHIP","TOOLS/BAUSHIP"],["ToolGfx/START","TOOLS/START"],["ToolGfx/SYMBOL","TOOLS/SYMBOL"],["ToolGfx/TOOLS","TOOLS/TOOLS"]],i=0;case 3:if(!(i<r.length)){t.next=23;break}return a=r[i],o=a[0]+".BSH",u=a[1],this.logger.info('Started parsing "'.concat(o,'".')),c=this.findFileCaseInsensitive(e,o),t.t0=n,t.next=12,d.default.fromZipObject(c);case 12:return t.t1=t.sent,t.next=15,t.t0.decodeBSH.call(t.t0,t.t1);case 15:return l=t.sent,f=n.createSpriteSheets(l),t.next=19,n.saveSpriteSheets(this.fs,f,"/gfx/".concat(u));case 19:this.logger.info('Finished parsing "'.concat(o,'".'));case 20:i++,t.next=3;break;case 23:case"end":return t.stop()}},t,this)}))}},{key:"parseTranslations",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.logger.info("Started parsing translations."),n=this.findFileCaseInsensitive(e,"text.cod"),r=new u.default,t.t0=p.default,t.t1=r,t.next=7,d.default.fromZipObject(n);case 7:return t.t2=t.sent,t.t3=t.t1.decrypt.call(t.t1,t.t2),i=(0,t.t0)(t.t3),t.next=12,this.fs.write("/translations.json",JSON.stringify(i));case 12:return this.logger.info("Finished parsing translations."),t.abrupt("return",i.PATH[0]);case 14:case"end":return t.stop()}},t,this)}))}},{key:"parseZEIs",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,u,c,l,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.mkdir("/fonts");case 2:n=new s.default,r=new h.default,i=["ZEI11A","ZEI14A","ZEI14V","ZEI16G","ZEI16H","ZEI16V","ZEI20H","ZEI20V","ZEI24V","ZEI28V","ZEI2","ZEI9A"],a=0;case 6:if(!(a<i.length)){t.next=30;break}return o=i[a],u="TOOLGFX/".concat(o,".ZEI"),this.logger.info('Started parsing "'.concat(u,'".')),c=this.findFileCaseInsensitive(e,u),t.t0=n,t.next=14,d.default.fromZipObject(c);case 14:return t.t1=t.sent,t.next=17,t.t0.decodeZEI.call(t.t0,t.t1);case 17:return l=t.sent,f=n.createSpriteSheets(l),t.next=21,n.saveSpriteSheets(this.fs,f,"/fonts/".concat(o));case 21:return t.next=23,r.createBitmapFont(f,o);case 23:return p=t.sent,t.next=26,this.fs.write("/fonts/".concat(o,"/font.xml"),p);case 26:this.logger.info('Finished parsing "'.concat(u,'".'));case 27:a++,t.next=6;break;case 30:case"end":return t.stop()}},t,this)}))}},{key:"parseMusic",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,d,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.mkdir("/music");case 2:if(this.hasFolderCaseInsensitive(e,"MUSIC8")){t.next=5;break}return this.logger.warn("No music files found."),t.abrupt("return");case 5:return n=new f.default,t.next=8,this.findFilesInZip(e,"MUSIC8",".wav");case 8:r=t.sent,i=!0,a=!1,o=void 0,t.prev=12,s=r[Symbol.iterator]();case 14:if(i=(u=s.next()).done){t.next=30;break}return c=u.value,l=c.path.substr(1),this.logger.info("Converting song ".concat(l)),t.t0=n,t.next=21,c.file.async("uint8array");case 21:return t.t1=t.sent,d=t.t0.decode.call(t.t0,t.t1),h=n.encode(d),t.next=26,this.fs.write("/music/".concat(l),h);case 26:this.logger.info("Finished converting song ".concat(l));case 27:i=!0,t.next=14;break;case 30:t.next=36;break;case 32:t.prev=32,t.t2=t.catch(12),a=!0,o=t.t2;case 36:t.prev=36,t.prev=37,i||null==s.return||s.return();case 39:if(t.prev=39,!a){t.next=42;break}throw o;case 42:return t.finish(39);case 43:return t.finish(36);case 44:case"end":return t.stop()}},t,this,[[12,32,36,44],[37,,39,43]])}))}},{key:"parseVideos",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,d,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.mkdir("/videos");case 2:if(this.hasFolderCaseInsensitive(e,"VIDEOSMK")){t.next=5;break}return this.logger.warn("No video files found."),t.abrupt("return");case 5:return n=new l.default,t.next=8,this.findFilesInZip(e,"VIDEOSMK",".smk");case 8:r=t.sent,i=!0,a=!1,o=void 0,t.prev=12,s=r[Symbol.iterator]();case 14:if(i=(u=s.next()).done){t.next=30;break}return c=u.value,d=c.path.substr(1),this.logger.info("Converting video ".concat(d)),t.next=20,c.file.async("uint8array");case 20:return f=t.sent,t.next=23,n.parse(f);case 23:return h=t.sent,t.next=26,this.fs.write("/videos/".concat(d.replace(".smk",".mp4")),h);case 26:this.logger.info("Finished converting video ".concat(d));case 27:i=!0,t.next=14;break;case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(12),a=!0,o=t.t0;case 36:t.prev=36,t.prev=37,i||null==s.return||s.return();case 39:if(t.prev=39,!a){t.next=42;break}throw o;case 42:return t.finish(39);case 43:return t.finish(36);case 44:case"end":return t.stop()}},t,this,[[12,32,36,44],[37,,39,43]])}))}},{key:"copyIslands",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([["NOKLIMA","/islands/noklima"],["NORD","/islands/north"],["NORDNAT","/islands/northnat"],["SUED","/islands/south"],["SUEDNAT","/islands/southnat"]].map(function(t){return n.copyFolderFromZip(e,t[0],t[1],".scp")})));case 1:case"end":return t.stop()}},t,this)}))}},{key:"copySaves",value:function(e){return w(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.copyFolderFromZip(e,"SAVEGAME","/saves",".gam");case 2:case"end":return t.stop()}},t,this)}))}},{key:"copyMissions",value:function(e,t){return w(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.copyFolderFromZip(e,"Szenes","/missions-original",".szm|.szs|.hss");case 2:return n.next=4,this.copyFolderFromZip(e,t,"/missions-custom",".szm|.szs|.hss");case 4:case"end":return n.stop()}},n,this)}))}},{key:"copyFolderFromZip",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return w(this,void 0,void 0,regeneratorRuntime.mark(function a(){var o,s,u,c,l,d,f,h,p,m;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat(t,"/"),this.logger.info("Copying '".concat(r,"' files from '").concat(t,"' to '").concat(n,"'.")),o=this.findFilesInZip(e,t,r),a.next=5,this.fs.mkdir(n);case 5:s=!0,u=!1,c=void 0,a.prev=8,l=o[Symbol.iterator]();case 10:if(s=(d=l.next()).done){a.next=26;break}return f=d.value,h=i?f.path.toLowerCase():f.path,p=f.file,m="".concat(n,"/").concat(h),this.logger.info("Copying '".concat(h,"' to '").concat(m,"'.")),a.t0=this.fs,a.t1=m,a.next=20,p.async("blob");case 20:return a.t2=a.sent,a.next=23,a.t0.write.call(a.t0,a.t1,a.t2);case 23:s=!0,a.next=10;break;case 26:a.next=32;break;case 28:a.prev=28,a.t3=a.catch(8),u=!0,c=a.t3;case 32:a.prev=32,a.prev=33,s||null==l.return||l.return();case 35:if(a.prev=35,!u){a.next=38;break}throw c;case 38:return a.finish(35);case 39:return a.finish(32);case 40:case"end":return a.stop()}},a,this,[[8,28,32,40],[33,,35,39]])}))}},{key:"findFilesInZip",value:function(e,t,n){var r=[];return e.forEach(function(e,i){if(e.startsWith(t)){var a=!0,o=!1,s=void 0;try{for(var u,c=n.split("|")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(e.toLowerCase().endsWith(l.toLowerCase())){e=(e=e.substring(t.length)).substring(0,e.length-l.length),e+=l,r.push({path:e,file:i});break}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}}}),r}},{key:"findFileCaseInsensitive",value:function(e,t){var n=new RegExp(x(t),"i"),r=e.file(n)[0];if(void 0===r)throw new Error("Could not find file ".concat(t,"."));return r}},{key:"hasFolderCaseInsensitive",value:function(e,t){var n=new RegExp(x(t),"i");return void 0!==e.folder(n)[0]}}])&&b(t.prototype,n),g&&b(t,g),e}();t.default=k},"2bhA":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),i=n("vurl");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t}var t,n,s;return t=e,(n=[{key:"load",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,a,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={ZEI20V:{size:24}},n=Object.keys(t),a=regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n[o],console.log("Loading font ".concat(t,".")),e.next=4,s.fs.openAndGetContentAsUint8Array("/fonts/".concat(t,"/font.xml"));case 4:return a=e.sent,e.next=7,new Promise(function(e){r.loader.add(t,"data:application/xml;base64,".concat((0,i.uInt8ToBase64)(a))).load(e)});case 7:console.log("Finished loading font ".concat(t,"."));case 8:case"end":return e.stop()}},e,this)}),o=0;case 4:if(!(o<n.length)){e.next=9;break}return e.delegateYield(a(),"t0",6);case 6:o++,e.next=4;break;case 9:case"end":return e.stop()}},e,this)}))}}])&&a(t.prototype,n),s&&a(t,s),e}();t.default=s},"2yww":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ"));function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},s=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.configLoader=n,this.spriteLoader=r,this.inited=!1,this.fields=new Map,this.textures=new Map}var t,n,s;return t=e,(n=[{key:"getIslandSprites",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inited){t.next=6;break}return t.next=3,this.spriteLoader.getTextures("STADTFLD");case 3:this.textures=t.sent,this.fields=this.configLoader.getFieldData(),this.inited=!0;case 6:return n=[],e.forEach(function(e){for(var t=0;t<e.size.x;t++)for(var i=0;i<e.size.y;i++)r.handleField(e.baseFields[t][i],e,t,i,n,"land");for(var a=0;a<e.size.x;a++)for(var o=0;o<e.size.y;o++)r.handleField(e.topFields[a][o],e,a,o,n,"building")}),t.abrupt("return",n);case 9:case"end":return t.stop()}},t,this)}))}},{key:"handleField",value:function(e,t,n,a,o,s){if(null!==e){var u=this.fields.get(e.fieldId);if(void 0===u)throw new Error("Could not load config for ".concat(e.fieldId,"."));var c=new r.Point(t.position.x+n,t.position.y+a),l=u.getSprites(c,e.rotation,e.ani,this.textures,s);o.push.apply(o,i(l))}}}])&&a(t.prototype,n),s&&a(t,s),e}();t.default=s},3:function(e,t){},4:function(e,t,n){n("ZPch"),n("55Il"),e.exports=n("/7QA")},"466s":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n("cE7O"))&&r.__esModule?r:{default:r},a=n("vurl");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},u=n("7GJN"),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filer=new u}var t,n,r;return t=e,(n=[{key:"root",value:function(){return this.filer.fs.root}},{key:"init",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return n.filer.init({persistent:!0,size:e},t,r)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"create",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return n.filer.create(e,!1,t,r)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"mkdir",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return n.filer.mkdir(e,!1,t,r)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"ls",value:function(e,t){return s(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(t,n){a.filer.ls(e,t,n)});case 2:if(r=n.sent,t){n.next=5;break}return n.abrupt("return",r);case 5:return i=t.split("|"),n.abrupt("return",r.filter(function(e){return e.isFile&&i.some(function(t){return e.name.endsWith(t)})}));case 7:case"end":return n.stop()}},n,this)}))}},{key:"exists",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.fullPath?e.fullPath:e).startsWith("/")){t.next=3;break}throw new Error('exists() only works with absolute paths, "'.concat(n,'" given.'));case 3:r=n.split("/").filter(function(e){return""!==e}),n="",i=!0,a=!1,o=void 0,t.prev=8,s=r[Symbol.iterator]();case 10:if(i=(u=s.next()).done){t.next=22;break}return c=u.value,n+="/",t.next=15,this.ls(n);case 15:if(l=t.sent,n+=c,void 0!==l.find(function(e){return e.fullPath===n})){t.next=19;break}return t.abrupt("return",!1);case 19:i=!0,t.next=10;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(8),a=!0,o=t.t0;case 28:t.prev=28,t.prev=29,i||null==s.return||s.return();case 31:if(t.prev=31,!a){t.next=34;break}throw o;case 34:return t.finish(31);case 35:return t.finish(28);case 36:return t.abrupt("return",!0);case 37:case"end":return t.stop()}},t,this,[[8,24,28,36],[29,,31,35]])}))}},{key:"open",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return n.filer.open(e,t,r)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"openAndGetContentAsText",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this,t.next=3,this.open(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.getTextContentFromFile.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t,this)}))}},{key:"openAndGetContentAsStream",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i.default,t.t1=this,t.next=4,this.open(e);case 4:return t.t2=t.sent,t.next=7,t.t1.getUint8ContentFromFile.call(t.t1,t.t2);case 7:return t.t3=t.sent,t.abrupt("return",new t.t0(t.t3));case 9:case"end":return t.stop()}},t,this)}))}},{key:"openAndGetContentAsUint8Array",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this,t.next=3,this.open(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.getUint8ContentFromFile.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t,this)}))}},{key:"getTextContentFromFile",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){var r=new FileReader;r.onload=function(e){null!==e.target?t(e.target.result):n()},r.onerror=function(e){n()},r.readAsText(e)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"getUint8ContentFromFile",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){var r=new FileReader;r.onload=function(e){null!==e.target?t(new Uint8Array(e.target.result)):n()},r.onerror=function(e){n()},r.readAsArrayBuffer(e)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"df",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){t.filer.df(function(t,n,r){return e({used:t,free:n,cap:r})},n)}));case 1:case"end":return e.stop()}},e,this)}))}},{key:"write",value:function(e,t){return s(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,i){return r.filer.write(e,{data:t},n,i)}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"rm",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){return n.filer.rm(e,t,r)}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"rmRoot",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ls("/");case 2:return t=e.sent,e.abrupt("return",Promise.all(t.map(function(e){return n.rm(e)})));case 4:case"end":return e.stop()}},e,this)}))}},{key:"download",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.ls(e);case 3:n=t.sent,t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",this.downloadFile(e));case 9:return t.abrupt("return",this.downloadDirectory(n));case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"downloadFile",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n="string"==typeof e?e:e.fullPath,t.next=3,this.openAndGetContentAsUint8Array(e);case 3:r=t.sent,(i=document.createElement("a")).setAttribute("href","data:application/json;base64,".concat((0,a.uInt8ToBase64)(r))),i.setAttribute("download",n),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i);case 11:case"end":return t.stop()}},t,this)}))}},{key:"downloadDirectory",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=!0,r=!1,i=void 0,t.prev=3,a=e[Symbol.iterator]();case 5:if(n=(o=a.next()).done){t.next=12;break}return s=o.value,t.next=9,this.download(s);case 9:n=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),r=!0,i=t.t0;case 18:t.prev=18,t.prev=19,n||null==a.return||a.return();case 21:if(t.prev=21,!r){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])}))}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=c},"5+n8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("cwy+");var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ"));function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.playing=!1,this.songs=[]}var t,n,o;return t=e,(n=[{key:"load",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fs.ls("/music");case 2:t=e.sent,n=!0,r=!1,i=void 0,e.prev=6,a=t[Symbol.iterator]();case 8:if(n=(o=a.next()).done){e.next=25;break}return s=o.value,console.log("Loading music ".concat(s.name)),e.next=13,this.fs.openAndGetContentAsUint8Array(s);case 13:return u=e.sent.buffer,e.t0=this.songs,e.t1=s.name,e.next=18,this.loadSound(u);case 18:e.t2=e.sent,e.t3={name:e.t1,sound:e.t2},e.t0.push.call(e.t0,e.t3),console.log("Finished loading music ".concat(s.name));case 22:n=!0,e.next=8;break;case 25:e.next=31;break;case 27:e.prev=27,e.t4=e.catch(6),r=!0,i=e.t4;case 31:e.prev=31,e.prev=32,n||null==a.return||a.return();case 34:if(e.prev=34,!r){e.next=37;break}throw i;case 37:return e.finish(34);case 38:return e.finish(31);case 39:case"end":return e.stop()}},e,this,[[6,27,31,39],[32,,34,38]])}))}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.songs.find(function(t){return t.name===e+".wav"});void 0!==n?n.sound.isPlaying||n.sound.play({loop:t}):console.warn("Song ".concat(e," not found."))}},{key:"playAll",value:function(){0!==this.songs.length?this.playing?console.warn("Music is already playing!"):(this.stop(),this.playing=!0,this.currentSongIdx=-1,this.playNext()):console.warn("No music to play found :(")}},{key:"stop",value:function(){this.songs.forEach(function(e){return e.sound.stop()})}},{key:"playNext",value:function(){this.currentSongIdx++,this.currentSongIdx===this.songs.length&&(this.currentSongIdx=0),this.songs[this.currentSongIdx].sound.play(this.playNext.bind(this))}},{key:"loadSound",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(n,i){var a=r.sound.Sound.from({source:e,preload:t,singleInstance:!0,loaded:function(e,r){t&&(e?i(e):n(r))}});t||n(a)})}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=o},"5FwS":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("LCUA")),i=o(n("a/P+")),a=o(n("lXCB"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},c=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.menuStructure=n,this.buttons=[this.renderNewGame.bind(this),this.renderLoadGame.bind(this),function(){return u(i,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.menuStructure.renderScreen("menu_loading");case 2:this.menuStructure.emit("load-game","/saves/lastgame.gam");case 3:case"end":return e.stop()}},e,this)}))},function(){return u(i,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.menuStructure.renderScreen("menu_main"));case 1:case"end":return e.stop()}},e,this)}))},function(e){return u(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentPage=Math.max(0,this.currentPage-1),t.next=3,this.renderNewGame(e);case 3:case"end":return t.stop()}},t,this)}))},function(e){return u(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentPage=Math.min(Math.ceil(this.newGameLines.length/this.ROWS)-1,this.currentPage+1),t.next=3,this.renderNewGame(e);case 3:case"end":return t.stop()}},t,this)}))}],this.ROWS=14,this.SCROLL_UP="menu-31011",this.SCROLL_DOWN="menu-31012",this.newGameLines=[],this.currentPage=0,this.gamParser=new r.default(null)}var t,n,o;return t=e,(n=[{key:"onLoad",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNewGameLines();case 2:return t.next=4,this.renderNewGame(e);case 4:return t.next=6,this.menuStructure._playMainMenuMusic();case 6:case"end":return t.stop()}},t,this)}))}},{key:"renderNewGame",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=this.currentPage*this.ROWS,r=0;r<this.ROWS;r++)(i=e.getChildByName("menu-".concat(31021+r))).off("click"),i.visible=!1,i.interactive=!1,i.buttonMode=!1,r+n<this.newGameLines.length&&function(){var e=s.newGameLines[r+n];i.text=e.name,i.visible=!0,e.file&&(i.interactive=!0,i.buttonMode=!0,i.once("click",function(){return u(s,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.menuStructure.renderScreen("menu_loading");case 2:this.menuStructure.emit("load-game",e.file.fullPath);case 3:case"end":return t.stop()}},t,this)}))}))}();for(a=0;a<this.ROWS;a++)e.getChildByName("menu-".concat(31041+a)).visible=a+n<this.newGameLines.length&&!!this.newGameLines[a+n].file;for(o=0;o<this.ROWS;o++)e.getChildByName("menu-".concat(31061+o)).visible=!1;e.getChildByName(this.SCROLL_UP).visible=!0,e.getChildByName(this.SCROLL_DOWN).visible=!0;case 6:case"end":return t.stop()}},t,this)}))}},{key:"renderLoadGame",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.ls("/saves",".gam");case 2:for(t.t0=function(e){return"lastgame.gam"!==e.name},n=t.sent.filter(t.t0),r=12,i=function(t){var i=e.getChildByName("menu-".concat(31021+t));i.visible=t<r,t<n.length?(i.text="Game".concat(t.toString().padStart(2,"0")),i.interactive=!0,i.buttonMode=!0,i.once("click",function(){return u(s,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.menuStructure.renderScreen("menu_loading");case 2:this.menuStructure.emit("load-game",n[t].fullPath);case 3:case"end":return e.stop()}},e,this)}))})):i.text="Empty".concat(t.toString().padStart(2,"0"))},a=0;a<this.ROWS;a++)i(a);for(a=0;a<this.ROWS;a++)e.getChildByName("menu-".concat(31041+a)).visible=!1;for(o=0;o<this.ROWS;o++)e.getChildByName("menu-".concat(31061+o)).visible=o<r;e.getChildByName(this.SCROLL_UP).visible=!1,e.getChildByName(this.SCROLL_DOWN).visible=!1;case 11:case"end":return t.stop()}},t,this)}))}},{key:"getNewGameLines",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadMissions();case 2:return t=e.sent,this.newGameLines.push({name:(0,i.default)("menu.divider.orginal_missions")}),t.filter(function(e){return-1!==e.missionNum}).forEach(function(e){n.newGameLines.push({name:e.name,file:e.file})}),this.newGameLines.push({name:(0,i.default)("menu.divider.missions")}),this.newGameLines.push({name:(0,i.default)("menu.divider.new_missions")}),t.filter(function(e){return-1===e.missionNum}).forEach(function(e){n.newGameLines.push({name:e.name,file:e.file})}),this.newGameLines.push({name:(0,i.default)("menu.divider.custom_missions")}),e.next=11,this.fs.ls("/missions-custom",".szs");case 11:e.sent.forEach(function(e){n.newGameLines.push({name:e.name.replace(".szs",""),file:e})});case 13:case"end":return e.stop()}},e,this)}))}},{key:"loadMissions",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,this.fs.ls("/missions-original",".szs");case 3:return e.t1=function(e){return u(n,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.openAndGetContentAsStream(e);case 2:return n=t.sent,r=this.gamParser.parse(n),i=-1,r.has("SZENE_RANKING")&&((0,a.default)(1===r.get("SZENE_RANKING").length),i=r.get("SZENE_RANKING")[0].data.read32()),o=-1,r.has("SZENE_KAMPAGNE")&&((0,a.default)(1===r.get("SZENE_KAMPAGNE").length),o=r.get("SZENE_KAMPAGNE")[0].data.read32()),s=-1,r.has("SZENE_MISSNR")&&((0,a.default)(1===r.get("SZENE_MISSNR").length),s=r.get("SZENE_MISSNR")[0].data.read32()),t.abrupt("return",{blocks:r,ranking:i,campaignNum:o,missionNum:s,name:e.name,file:e});case 11:case"end":return t.stop()}},t,this)}))},e.t2=e.sent.map(e.t1),e.next=7,e.t0.all.call(e.t0,e.t2);case 7:return(t=e.sent).sort(function(e,t){return-1!==e.missionNum&&-1===t.missionNum?-1:-1===e.missionNum&&-1!==t.missionNum?1:-1!==e.missionNum&&-1!==t.missionNum?e.missionNum<t.missionNum?-1:e.missionNum>t.missionNum?1:0:0}),console.table(t),e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)}))}}])&&s(t.prototype,n),o&&s(t,o),e}();t.default=c},"7o3K":function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("V4eY"),a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n,this.pixels=r}var t,n,a;return t=e,(n=[{key:"toPNG",value:function(){return i.encode([this.pixels.buffer],this.width,this.height)}}])&&r(t.prototype,n),a&&r(t,a),e}();t.default=a},"8si9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("+7RP");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.world=t,this.islandRenderer=n,this.viewport=r}var t,n,o;return t=e,o=[{key:"fieldPosToWorldPos",value:function(e){var t=e.x,n=e.y,i=(t-n)*(r.TILE_WIDTH/2),a=(t+n)*Math.floor(r.TILE_HEIGHT/2);return new PIXI.Point(i,a)}}],(n=[{key:"begin",value:function(e){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.viewport.removeChildren(),t.next=3,this.islandRenderer.render(this.world.islands);case 3:this.moveCameraToStartPosition(e);case 4:case"end":return t.stop()}},t,this)}))}},{key:"zoom",value:function(e){var t=this.viewport.center;this.viewport.scale.set(1/e),this.viewport.moveCenter(t.x,t.y)}},{key:"moveCameraToStartPosition",value:function(e){var t=this.world.kontors.find(function(t){return t.playerId===e});if(void 0===t){var n=this.world.ships.find(function(t){return t.playerId===e});void 0===n?this.moveTo(new PIXI.Point(250,150)):this.moveTo(n.position)}else{var r=t.position,i=this.world.islands.find(function(e){return e.id===t.islandId});this.moveTo(new PIXI.Point(i.position.x+r.x,i.position.y+r.y))}}},{key:"moveTo",value:function(t){this.viewport.moveCenter(e.fieldPosToWorldPos(t))}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=o},"96T+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("q1tI"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},d=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=s(t).call(this,e),(n=!o||"object"!==i(o)&&"function"!=typeof o?c(r):o).info=function(e){n.log(e,"info")},n.warn=function(e){n.log(e,"warn")},n.error=function(e){n.log(e,"error")},n.log=function(e,t){n.setState(function(n){return Object.assign({},n,{messages:[{msg:e,type:t}].concat(a(n.messages))})})},n.zipUploaded=function(e){return l(c(c(n)),void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.target.files)&&1===n.length){t.next=4;break}return alert("Please select the zipped Anno1602 folder to upload."),t.abrupt("return");case 4:if((r=n[0]).name.endsWith(".zip")){t.next=8;break}return alert("You need to upload a .zip file!"),t.abrupt("return");case 8:return this.setState({isUploading:!0}),t.next=11,this.props.onUploaded(r);case 11:i=t.sent,this.setState({isUploading:!1}),i?(this.info("Upload finished. Please reload the page."),alert("Upload finished. Please reload the page.")):(this.error("The upload failed."),alert("The upload failed."));case 14:case"end":return t.stop()}},t,this)}))},n.resetFiles=function(){return l(c(c(n)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.onReset();case 2:alert("All files deleted. The page will now refresh."),window.location.reload(!0);case 4:case"end":return e.stop()}},e,this)}))},n.state={isUploading:!1,messages:[]},n.props.setLogger(c(c(n))),n}var n,d,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,r.Component),n=t,(d=[{key:"render",value:function(){return r.createElement("div",{style:{marginLeft:"1em",marginRight:"1em",fontFamily:"Arial",maxWidth:"800px",lineHeight:1.4}},r.createElement("h1",null,"Anno 2018"),r.createElement("p",null,"Welcome to Anno 2018, an effort to port twenty-year-old Anno 1602 to the browser. This is in early development, however, you can already load your savegames and start new games. Much of the actual simulation is still missing though. For copyright reasons, we can't include the original Anno 1602 files and graphics."," ",r.createElement("strong",null,"You need own your own copy of Anno 1602 for Anno 2018 work.")),r.createElement("p",null,"The following versions have been tested by us and confirmed to work:"),r.createElement("ul",null,r.createElement("li",null,'German "Anno 1602 Kngisedition"'),r.createElement("li",null,'English "Anno 1602 A.D." from GOG')),r.createElement("p",null,"Anno 2018 is tested in the latest versions of"," ",r.createElement("strong",null,"Chrome (preferred, faster) and Firefox")," only. Other browsers ",r.createElement("em",null,"might")," work, but aren't supported."),r.createElement("p",null,'To get started, follow these steps. You will need to "upload" your Anno files on this website. Don\'t worry though, the files'," ",r.createElement("em",null,"never")," leave your PC and are only uploaded into your browser. Once uploaded, the files remain in your browser and will be there when you re-open this website."),r.createElement("ol",null,r.createElement("li",null,"Find your Anno 1602 files and zip them. If you are using a version of Anno 1602 which came with a physical CD, copy the videosmk and music8 folders into your Anno 1602 root folder before creating the zip file."),r.createElement("li",null,"Use the upload button below to upload the zip file. The file should be around 50MB if it doesn't contain music and videos, and around 500MB if it does."),r.createElement("li",null,r.createElement("p",null,"Grab a coffee. The upload takes some time. Progress is being logged below. Should anything go wrong, take a look at the error message. It might tell you what to do. If it doesn't, make sure you're using a recent version of Chrome or Firefox. If it is still not working,"," ",r.createElement("a",{href:"https://reddit.com/u/cmfcmf"},"drop me a note at reddit"),", ",r.createElement("a",{href:"https://twitter.com/christianmflach"},"twitter"),", or"," ",r.createElement("a",{href:"https://github.com/cmfcmf/Anno2018-js"},"create an issue at GitHub"),". Make sure to include the upload progress output."),"Upload:"," ",r.createElement("input",{type:"file",multiple:!1,accept:".zip",onChange:this.zipUploaded,disabled:this.state.isUploading}))),r.createElement("h2",null,"Upload Progress ",r.createElement("small",null,"(newest at the top)")),0===this.state.messages.length&&r.createElement("p",null,"Nothing yet..."),r.createElement("div",{style:{fontSize:"10px"}},this.state.messages.map(function(e,t){return r.createElement("div",{key:t},r.createElement("span",{style:{color:"info"===e.type?"blue":"warn"===e.type?"orange":"red"}},e.type.toUpperCase()),": ",e.msg)})),r.createElement("h2",null,"Uploading custom missions and additional savegames"),r.createElement("p",null,"Use this button to upload additional missions or savegames after you uploaded the main game:"," ",r.createElement("input",{type:"file",multiple:!0,accept:".szm,.szs,.gam",onChange:this.props.onSaveOrMissionUploaded})),r.createElement("h2",null,"Resetting files"),r.createElement("p",null,'You can use the "Reset all files" button to delete all uploaded files if needed: ',r.createElement("button",{onClick:this.resetFiles},"Reset all files")))}}])&&o(n.prototype,d),f&&o(n,f),t}();t.default=d},"9IE/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kontorFromSaveGame=function(e){var t=e.read8(),n=new PIXI.Point(e.read8(),e.read8()),r=e.read8(),a=function(e){for(var t=[],n=0;n<2;n++)i.default.fromSaveGame(e);for(var r=2;r<25;r++)t.push(i.default.fromSaveGame(e));for(var a=25;a<50;a++)i.default.fromSaveGame(e);return t}(e);return{islandId:t,position:n,playerId:r,goods:a}};var r,i=(r=n("vqtW"))&&r.__esModule?r:{default:r}},BdDv:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ContractState=void 0,t.ContractState=i,function(e){e[e.Inactive=0]="Inactive",e[e.OfferedByMe=1]="OfferedByMe",e[e.OfferedByOther=2]="OfferedByOther",e[e.Active=3]="Active"}(i||(t.ContractState=i={}));var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=t,this.time=n}var t,n,i;return t=e,i=[{key:"fromSaveGame",value:function(t){return new e(t.read32(),t.read32())}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.default=a},BplM:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.castleFromSaveGame=function(e){var t=e.read8(),n=new PIXI.Point(e.read8(),e.read8());e.read8(),e.read32();var r=e.read16(),a=e.read16(),o=e.read16();e.read16();var s=function(e){for(var t=[],n=0;n<8;n++)t.push(i.fromSaveGame(e));return t}(e);return e.read(32),{islandId:t,position:n,numSwords:r,numMuscets:a,numCanons:o,units:s}};var i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.ready=n,this.hp=r}var t,n,i;return t=e,i=[{key:"fromSaveGame",value:function(t){var n=t.read8(),r=t.read8();t.read16();var i=t.read16();return t.read16(),new e(n,0!=(16&r),i)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}()},Ca1k:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root={x:0,y:0,w:t,h:n}}var t,n,i;return t=e,(n=[{key:"addBlock",value:function(e){var t=this.findNode(this.root,e.w,e.h);return!!t&&this.splitNode(t,e.w,e.h)}},{key:"findNode",value:function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:null}},{key:"splitNode",value:function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=i},DfYP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("XH0y")),a=(r=n("lXCB"))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.log=i.getLogger("dat-parser")}var t,n,r;return t=e,(n=[{key:"parse",value:function(e){this.variables=new Map,this.objects={},this.template=null,this.gfxMap=new Map,this.lastGfxName=null,this.currentObject=null,this.currentNestedObject=null,this.currentItem=null,this.currentNestedItem=0;var t=!0,n=!1,r=void 0;try{for(var i,a=e.split("\n")[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(0!==(o=o.split(";")[0].trim()).length&&!(o.startsWith("Nahrung:")||o.startsWith("Soldat:")||o.startsWith("Turm:")||o.startsWith("Include:"))){var s=void 0;if(s=o.match(/^(@?)(\w+)\s*=\s*((?:\d+|\+|\w+)+)$/))this.handleConstantAssignment(s);else if(s=o.match(/^ObjFill:\s*([\w,]+)$/))this.handleObjFill(s);else if(s=o.match(/^Objekt:\s*(\w+)$/))this.handleNestedObjectBegin(s);else if("EndObj"!==o){if(!(s=o.match(/^(@?)(\w+):\s*(.*?)\s*$/)))throw new Error("Could not parse: "+o);this.handleProperty(s)}else this.handleNestedObjectEnd()}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{variables:this.mapToObject(this.variables),objects:this.objects,gfx_category_map:this.mapToObject(this.gfxMap)}}},{key:"handleObjFill",value:function(e){(0,a.default)(null!=this.currentObject),(0,a.default)(null!=this.currentItem);var t=e[1],n=this.objects[this.currentObject].items[this.currentItem];if(t.startsWith("0,MAX"))(0,a.default)(null===this.template),this.template=n;else{(0,a.default)(n.hasOwnProperty("nested_objects"));var r=this.getValue(null,t,!1),i=this.objects[this.currentObject].items[r];this.objects[this.currentObject].items[this.currentItem]=this.deepCopy(i),null!=this.lastGfxName&&(n.GfxCategory=this.lastGfxName)}}},{key:"handleConstantAssignment",value:function(e){var t=e[1].length>0,n=e[2],r=e[3];if(n.startsWith("GFX"))if("0"===r)this.gfxMap.set(n,n);else if(r.startsWith("GFX")){var i=r.split("+")[0];this.gfxMap.has(i)&&this.gfxMap.set(n,this.gfxMap.get(i))}this.variables.set(n,this.getValue(n,r,t))}},{key:"handleNestedObjectBegin",value:function(e){var t=e[1];if(null===this.currentObject)this.currentObject=t,this.objects[t]={items:{}};else{if(null!==this.currentNestedObject)throw new Error("It appears like there is more than one nesting level. This is not supported by this parser.");(0,a.default)(null!==this.currentItem),this.currentNestedObject=t,this.currentNestedItem=0;var n=this.objects[this.currentObject].items[this.currentItem];void 0!==n.nested_objects[this.currentNestedObject]&&void 0!==n.nested_objects[this.currentNestedObject][this.currentNestedItem]||(n.nested_objects[this.currentNestedObject]=s({},this.currentNestedItem,{}))}}},{key:"handleNestedObjectEnd",value:function(){if(null!==this.currentNestedObject)this.currentNestedObject=null,this.currentNestedItem=null;else{if(null===this.currentObject)throw new Error("Received EndObj without current object!");this.currentObject=null,this.currentItem=null}}},{key:"handleProperty",value:function(e){var t=e[1].length>0,n=e[2],r=e[3],i=this.deepCopy(this.getValue(n,r,t));if(this.variables.set(n,i),"Nummer"!==n){var a=this.objects[this.currentObject].items[this.currentItem];if("Gfx"===n&&r.startsWith("GFX")&&(this.lastGfxName=r.split("+")[0]),null==this.currentNestedObject)a[n]=i,null!=this.lastGfxName&&(a.GfxCategory=this.lastGfxName,a.GfxCategoryMapped=this.gfxMap.get(this.lastGfxName));else{var o=a.nested_objects[this.currentNestedObject][this.currentNestedItem];Object.keys(o).includes(n)&&this.isObject(o[n])?o[n]=this.deepMerge(o[n],i):o[n]=i}}else if(null===this.currentNestedObject){if(this.currentItem=i,this.objects[this.currentObject].items[this.currentItem]={nested_objects:{}},null!==this.template){var s=this.deepCopy(this.template);this.objects[this.currentObject].items[this.currentItem]=this.deepMerge(s,this.objects[this.currentObject].items[this.currentItem])}}else this.currentNestedItem=i,this.objects[this.currentObject].items[this.currentItem].nested_objects[this.currentNestedObject][this.currentNestedItem]={}}},{key:"getValue",value:function(e,t,n){var r,i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(n&&(r=t.match(/^([+\-])(\d+)$/))){var o=this.variables.has(e)?this.deepCopy(this.variables.get(e)):null;if("RUINE_KONTOR_1"===o.toString()&&(o=424242),a>-1&&(o="Size"===e?o[0===a?"x":"y"]:o[a]),"+"===r[1])return o+parseInt(r[2],10);if("-"===r[1])return o-parseInt(r[2],10);throw new Error("This code should not be reached.")}if(t.match(/^[\-+]?\d+$/))return parseInt(t,10);if(t.match(/^[\-+]?\d+\.\d+$/))return parseFloat(t);if(r=t.match(/^([A-Za-z0-9_]+)(?:\[(\d+)])?$/)){var s=r[1],u=r[2],c=this.variables.has(s)?this.deepCopy(this.variables.get(s)):s;return void 0!==u?c[u]:c}if(-1!==t.indexOf(",")){var l=t.split(",").map(function(t,r){return i.getValue(e,t.trim(),n,r)});if("Size"===e)return{x:l[0],y:l[1]};if("Ware"===e){var d={};return d[l[0]]=l[1],d}return l}if(r=t.match(/^([A-z]+(?:\[\d+])?|\d+)([+\-])([A-z]+(?:\[\d+])?|\d+)$/)){var f=r[2],h=this.getValue(e,r[1],!1),p=this.getValue(e,r[3],!1);return"+"===f?h+p:h-p}throw new Error("This code should not be reached.")}},{key:"deepCopy",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"isObject",value:function(e){return e&&"object"===o(e)&&!Array.isArray(e)}},{key:"deepMerge",value:function(e,t){var n=this,r=Object.assign({},e);return this.isObject(e)&&this.isObject(t)&&Object.keys(t).forEach(function(i){n.isObject(t[i])&&i in e?r[i]=n.deepMerge(e[i],t[i]):Object.assign(r,s({},i,t[i]))}),r}},{key:"mapToObject",value:function(e){var t={};return e.forEach(function(e,n){return t[n]=e}),t}}])&&u(t.prototype,n),r&&u(t,r),e}();t.default=c},EVan:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("qVmS");var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),i=n("ANjH"),a=n("5HXA"),o=d(n("7cfX")),s=n("Q1FS"),u=n("ahDk"),c=d(n("lXCB")),l=n("UpaQ");function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},m="TICK",v="DONATE_MONEY",g="SET_SIMULATION_SPEED",y="PAY_UPKEEP";function b(e){return{type:g,payload:e}}function w(e,t){return{type:y,payload:{playerId:e,upkeep:t}}}var x=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gameRenderer=t,this.configLoader=n,this.timerId=null,this.myPlayerId=0,this.keyboardManager=r.keyboardManager,this.setupHotKeys()}var t,n,d;return t=e,(n=[{key:"begin",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={players:this.mapArrayById(e.players),islands:this.mapArrayById(e.islands),tasks:this.mapArrayById(e.tasks),cities:e.cities,kontors:e.kontors,producers:e.producers,timers:Object.assign({},e.timers,{simulationSpeed:l.SimulationSpeed.Paused})},this.store=(0,i.createStore)((0,i.combineReducers)({players:this.playerReducer,islands:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&arguments[1];return e},timers:this.timerReducer,tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&arguments[1];return e},cities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&arguments[1];return e},kontors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&arguments[1];return e},producers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&arguments[1];return e}}),n,(0,a.composeWithDevTools)()),this.watchSimulationSpeed(),this.watchTicksForUpkeep(),this.store.dispatch(b(l.SimulationSpeed.Default)),this.keyboardManager.enable(),t.next=8,this.gameRenderer.begin(this.myPlayerId);case 8:case"end":return t.stop()}},t,this)}))}},{key:"mapArrayById",value:function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})}},{key:"watchSimulationSpeed",value:function(){var e=this,t=(0,o.default)(this.store.getState,"timers.simulationSpeed");this.store.subscribe(t(function(t){null!==e.timerId&&clearInterval(e.timerId),t!==l.SimulationSpeed.Paused&&(e.timerId=setInterval(e.tick.bind(e),1e3/t))}))}},{key:"watchTicksForUpkeep",value:function(){var e,t=this,n=(0,o.default)(this.store.getState,"timers.timeGame");new s.Observable(function(e){t.store.subscribe(n(function(t){e.next(t)}))}).pipe((e=10,(0,u.filter)(function(t,n){return n%e==0}))).subscribe(function(){for(var e=t.calculateUpkeeps(),n=Object.keys(e),r=0;r<n.length;r++){var i=n[r],a=Math.floor(e[i]/6);t.store.dispatch(w(+i,a))}})}},{key:"calculateUpkeeps",value:function(){var e=this.store.getState(),t=Object.keys(e.players).reduce(function(e,t){return e[t]=0,e},{}),n=e.islands,r=e.producers,i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,d=n[l.islandId].topFields[l.position.x][l.position.y],f=d.fieldId,h=d.playerId;(0,c.default)(65535!==f),(0,c.default)(h<7);var p=this.configLoader.getFieldData().get(f);(0,c.default)(p),t[h]+=p.production.upkeep[l.active?"active":"inactive"]}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return t}},{key:"setupHotKeys",value:function(){var e=this,t=r.keyboard.Key,n=t.F1;this.keyboardManager.onKeyPressedWithPreventDefault(n,function(){var t=e.store.getState(),n=t.players[e.myPlayerId],r=t.tasks[n.assignedTaskId];void 0!==r?console.info(r.text):console.info("It appears like you have no task :/")});for(var i=[{key:t.F2,zoom:1},{key:t.F3,zoom:2},{key:t.F4,zoom:3}],a=function(){var t=i[o];e.keyboardManager.onKeyPressedWithPreventDefault(t.key,function(){return e.gameRenderer.zoom(t.zoom)})},o=0;o<i.length;o++)a();for(var s=[{keys:[t.PAUSE],speed:l.SimulationSpeed.Paused},{keys:[t.F5],speed:l.SimulationSpeed.Slow},{keys:[t.F6],speed:l.SimulationSpeed.Medium},{keys:[t.F7],speed:l.SimulationSpeed.Fast},{keys:[t.SHIFT,t.F8],speed:l.SimulationSpeed.SuperFast}],u=function(){var t=s[c];e.keyboardManager.onKeysPressedWithPreventDefault(t.keys,function(){return e.store.dispatch(b(t.speed))})},c=0;c<s.length;c++)u()}},{key:"tick",value:function(){this.store.dispatch({type:m})}},{key:"timerReducer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object.assign({},e,{gameTime:++e.timeGame});case g:return Object.assign({},e,{simulationSpeed:t.payload});default:return e}}},{key:"playerReducer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case v:var r=n.payload;return Object.assign({},t,(f(e={},r.fromPlayer,Object.assign({},t[r.fromPlayer],{money:t[r.fromPlayer].money-r.amount})),f(e,r.toPlayer,Object.assign({},t[r.toPlayer],{money:t[r.toPlayer].money+r.amount})),e));case y:var i=n.payload.playerId,a=n.payload.upkeep;return Object.assign({},t,f({},i,Object.assign({},t[i],{money:t[i].money-a})));default:return t}}}])&&h(t.prototype,n),d&&h(t,d),e}();t.default=x},EeBo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.islandFromIsland3File=s,t.islandFromIsland4File=function(e,t,n,r,i){return s(e,t,n,r,i)},t.islandFromIsland5File=function(e,t,n,r,i){return s(e,t,n,r,i)},t.islandFromSaveGame=function(e){var t=e.read8(),n=e.read8(),r=e.read8(),s=(e.read8(),e.read16()),u=e.read16();e.read16(),e.read16(),e.read(8);(0,a.default)(e.read(3).every(function(e){return 0===e}));e.read8(),e.read8Bool(),e.read8();var c=e.read8(),l=e.read8(),d=[o.OreLocation.fromSaveGame(e),o.OreLocation.fromSaveGame(e)],f=(e.read(48),function(e){return{tobacco:(e&1<<i.TOBACCO)>0,sugarcane:(e&1<<i.SUGARCANE)>0,wine:(e&1<<i.WINE)>0,cotton:(e&1<<i.COTTON)>0,cacao:(e&1<<i.CACAO)>0,spice:(e&1<<i.SPICE)>0}}(e.read32())),h=e.read16(),p=(e.read16(),e.read8Bool()),m=e.read8Bool();e.read8(),e.read8(),e.read32(),e.read32();(0,a.default)(0===e.read32());return{id:t,position:new PIXI.Point(s,u),size:new PIXI.Point(n,r),positionRect:new PIXI.Rectangle(s,u,n,r),numBaseIsland:h,numOreLocations:c,oreLocations:d,fertility:f,isSouth:p,differsFromBaseIsland:m,fertilityDiscovered:0!==l,baseFields:[],topFields:[]}};var r,i,a=(r=n("lXCB"))&&r.__esModule?r:{default:r},o=n("n/3h");function s(e,t,n,r,i){i.read8();var a=new PIXI.Point(i.read8(),i.read8());return{id:e,position:t,size:a,positionRect:new PIXI.Rectangle(t.x,t.y,a.x,a.y),numBaseIsland:r,numOreLocations:0,oreLocations:[],fertility:{tobacco:!1,sugarcane:!1,wine:!1,cotton:!1,cacao:!1,spice:!1},isSouth:n,differsFromBaseIsland:!1,fertilityDiscovered:!1,baseFields:[],topFields:[]}}!function(e){e[e.TOBACCO=1]="TOBACCO",e[e.SUGARCANE=3]="SUGARCANE",e[e.WINE=5]="WINE",e[e.COTTON=4]="COTTON",e[e.CACAO=6]="CACAO",e[e.SPICE=2]="SPICE"}(i||(i={}))},FfGF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cityFromSaveGame=function(e){for(var t=e.read8(),n=e.read8(),r=e.read16(),i=!e.read8Bool(),a=(e.read(87),[]),o=0;o<5;o++)a.push(e.read32());e.read(15);for(var s=[],u=0;u<5;u++)s.push(e.read8());e.read(3);var c=e.readString(33);return{islandId:t,playerId:r,cityIslandNum:n,progressAllowed:i,inhabitants:a,taxes:s,name:c}}},Iu1z:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i,a=(r=n("lXCB"))&&r.__esModule?r:{default:r};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i||(i={});var s=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.kind=t,this.otherPlayerId=n,this.time=r}var t,n,r;return t=e,r=[{key:"fromSaveGame",value:function(t){var n=t.read8(),r=t.read8();return(0,a.default)(0===t.read16()),new e(n,r,t.read32())}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.default=s},IuTw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n("XH0y")),i=n("/ia5"),a=c(n("lXCB")),o=c(n("Ca1k")),s=l(n("tDmD")),u=c(n("7o3K"));function c(e){return e&&e.__esModule?e:{default:e}}function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},h=n("V4eY"),p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.SPRITESHEET_SIZE=2048,this.HEADER_SIZE=20,this.log=r.getLogger("bsh-parser")}var t,n,c;return t=e,(n=[{key:"decodeBSH",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.decode(e,"BSH"));case 1:case"end":return t.stop()}},t,this)}))}},{key:"decodeZEI",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.decode(e,"ZEI"));case 1:case"end":return t.stop()}},t,this)}))}},{key:"createSpriteSheets",value:function(e){for(var t=[],n=new o.default(this.SPRITESHEET_SIZE,this.SPRITESHEET_SIZE),r=new Uint8Array(this.SPRITESHEET_SIZE*this.SPRITESHEET_SIZE*4),i={meta:{},frames:{}},a=0;a<e.length;a++){var s=e[a],u=n.addBlock({w:s.width,h:s.height});if(!1===u&&(t.push({png:h.encode([r.buffer],this.SPRITESHEET_SIZE,this.SPRITESHEET_SIZE),config:i}),n=new o.default(this.SPRITESHEET_SIZE,this.SPRITESHEET_SIZE),r=new Uint8Array(this.SPRITESHEET_SIZE*this.SPRITESHEET_SIZE*4),i={meta:{},frames:{}},u=n.addBlock({w:s.width,h:s.height})),!u)throw new Error("Could not add image to empty spritesheet!");for(var c=u.x,l=u.y,d=0,f=0;f<s.height;f++)for(var p=0;p<s.width;p++){var m=4*(c+p+this.SPRITESHEET_SIZE*f+this.SPRITESHEET_SIZE*l);r[m+0]=s.pixels[4*d+0],r[m+1]=s.pixels[4*d+1],r[m+2]=s.pixels[4*d+2],r[m+3]=s.pixels[4*d+3],d++}i.frames[a.toString(10)]={frame:{x:c,y:l,w:s.width,h:s.height},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:s.width,h:s.height},sourceSize:{w:s.width,h:s.height}}}return t.push({png:h.encode([r.buffer],this.SPRITESHEET_SIZE,this.SPRITESHEET_SIZE),config:i}),t}},{key:"saveSpriteSheets",value:function(e,t,n){return f(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.mkdir(n);case 2:i=0;case 3:if(!(i<t.length)){r.next=9;break}return r.next=6,this.saveSpriteSheet(e,t[i],i,n);case 6:i++,r.next=3;break;case 9:case"end":return r.stop()}},r,this)}))}},{key:"encodeBSH",value:function(e){var t=this,n=new i.SmartBuffer;return n.writeString("BSH".padEnd(16,"\0"),"ascii"),n.writeUInt32LE(42),e.forEach(function(){return n.writeUInt32LE(42)}),e.forEach(function(e,r){var i=t.encodeImage(e).toBuffer();n.writeUInt32LE(n.writeOffset-t.HEADER_SIZE,20+4*r),n.writeBuffer(i)}),n.writeUInt32LE(n.length-this.HEADER_SIZE,16),n.toBuffer()}},{key:"decode",value:function(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,s,u,c,l,d;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(r=e.readString(16),(0,a.default)(r===t),i=e.read32(),(0,a.default)(this.HEADER_SIZE+i===e.length),(o=[]).push(e.read32()),s=o[0]/4,u=1;u<s;u++)o.push(e.read32());for(c=[],l=0;l<s;l++)e.seek(o[l]+this.HEADER_SIZE),null!==(d=this.decodeImage(e))&&c.push(d);return n.abrupt("return",c);case 11:case"end":return n.stop()}},n,this)}))}},{key:"decodeImage",value:function(e){var t=e.read32(),n=e.read32();e.read32(),e.read32();(0,a.default)(t>0),(0,a.default)(n>0);for(var r=new Uint8Array(t*n*4),i=0,o=0;;){var c=e.read8();if(255===c)break;if(254===c)o=++i*t*4;else{o+=4*c;for(var l=e.read8(),d=0;d<l;d++){var f=3*e.read8();r[o++]=s.default[f],r[o++]=s.default[f+1],r[o++]=s.default[f+2],r[o++]=255}}}return new u.default(t,n,r)}},{key:"encodeImage",value:function(e){var t=new i.SmartBuffer;t.writeUInt32LE(e.width).writeUInt32LE(e.height).writeUInt32LE(1).writeUInt32LE(42);for(var n=0,r=0;r<e.height;r++){for(var a=0,o=[],u="empty",c=0;c<e.width;c++){var l=(e.pixels[4*(r*e.width+c)+0]<<24)+(e.pixels[4*(r*e.width+c)+1]<<16)+(e.pixels[4*(r*e.width+c)+2]<<8)+(e.pixels[4*(r*e.width+c)+3]<<0);if(0===l){if("empty"===u)a++;else if("colored"===u){for(;n>0;)t.writeUInt8(254),n--;for(;a>253;)t.writeUInt8(253),t.writeUInt8(0),a-=253;t.writeUInt8(a);for(var d=0;d<o.length;d+=255){var f=o.slice(d,d+255);d>0&&t.writeUInt8(0),t.writeUInt8(f.length),f.forEach(function(e){var n=s.colorsToIdx[e];t.writeUInt8(n)})}a=1,o=[]}u="empty"}else u="colored",o.push(l)}if("colored"===u){for(;n>0;)t.writeUInt8(254),n--;for(;a>253;)t.writeUInt8(253),t.writeUInt8(0),a-=253;t.writeUInt8(a);for(var h=0;h<o.length;h+=255){var p=o.slice(h,h+255);h>0&&t.writeUInt8(0),t.writeUInt8(p.length),p.forEach(function(e){t.writeUInt8(s.colorsToIdx[e.toString()])})}}n++}t.writeUInt8(255);for(var m=(4-t.length%4)%4,v=0;v<m;v++)t.writeUInt8(0);return t.writeUInt32LE(t.length,12),t}},{key:"saveSpriteSheet",value:function(e,t,n,r){return f(this,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.write("".concat(r,"/sprite-sheet-").concat(n,".png"),t.png);case 2:return i.next=4,e.write("".concat(r,"/sprite-sheet-").concat(n,".json"),JSON.stringify(t.config));case 4:case"end":return i.stop()}},i,this)}))}}])&&d(t.prototype,n),c&&d(t,c),e}();t.default=p},KTje:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),a=(r=n("8si9"))&&r.__esModule?r:{default:r};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t.Id,this.gfxId=t.Gfx,this.kind=t.Kind,this.size=new i.Point(t.Size.x,t.Size.y),this.rotate=t.Rotate,this.animAdd=t.AnimAdd,this.animAnz=t.AnimAnz,this.animTime="TIMENEVER"===t.AnimTime?-1:t.AnimTime,this.yOffset=-t.Posoffs;var n=t.nested_objects.HAUS_PRODTYP[0],r={active:0,inactive:0};Array.isArray(n.Kosten)?(r.active=n.Kosten[0],r.inactive=n.Kosten[1]):r.active=r.inactive=void 0!==n.Kosten?n.Kosten:0,this.production={good:n.Ware,upkeep:r}}var t,n,r;return t=e,(n=[{key:"getSprites",value:function(e,t,n,r,o){for(var s=[],u=t%2==0?this.size.x:this.size.y,c=t%2==0?this.size.y:this.size.x,l=0;l<c;l++)for(var d=0;d<u;d++){var f=e.x+d,h=e.y+l,p=a.default.fieldPosToWorldPos(new i.Point(f,h)),m=p.x,v=p.y,g=void 0;if(0===this.animAdd||-1===this.animTime){var y=this.getTexture(d,l,t,n,r);g=new i.Sprite(y)}else{for(var b=[],w=0;w<this.animAnz;w++)b.push(this.getTexture(d,l,t,w,r));var x=new i.extras.AnimatedSprite(b);x.animationSpeed=1/60*(1e3/this.animTime),x.play(),g=x}g.anchor.set(0,1),g.x=m,g.y=v+this.yOffset,s.push({sprite:g,position:new i.Point(f,h),layer:o})}return s}},{key:"getTexture",value:function(e,t,n,r,i){var a=this.gfxId;if(this.rotate>0&&(a+=n*this.size.x*this.size.y),a+=r*this.animAdd,0===n)a+=t*this.size.x+e;else if(1===n)a+=this.size.x*this.size.y-1-(e*this.size.x+(this.size.x-1-t));else if(2===n)a+=(this.size.y-1-t)*this.size.x+(this.size.x-1-e);else{if(3!==n)throw new Error("Invalid building rotation: ".concat(n,"."));a+=e*this.size.x+(this.size.x-1-t)}var o=i.get(a);if(void 0===o)throw new Error("Could not load texture ".concat(a,"."));return o}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=s},LCUA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("BplM"),i=n("FfGF"),a=n("EeBo"),o=n("9IE/"),s=n("hD6V"),u=n("e48e"),c=n("vR12"),l=n("pF7d"),d=n("tTUl"),f=n("Wxsv"),h=n("S+oN"),p=b(n("UpaQ")),m=b(n("mgMI")),v=b(n("lXCB")),g=n("PWAz"),y=b(n("0BjB"));function b(e){return e&&e.__esModule?e:{default:e}}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},S=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.islandLoader=t,this.worldGenerator=new y.default(t)}var t,n,b;return t=e,(n=[{key:"parse",value:function(e){for(var t=new Map;!e.eof();){var n=g.Block.fromStream(e);if("INSELHAUS"!==n.type)t.has(n.type)||t.set(n.type,[]),t.get(n.type).push(n);else{var r=t.get("INSEL5")[t.get("INSEL5").length-1];void 0===r.inselHausBlocks&&(r.inselHausBlocks=[]),r.inselHausBlocks.push(n)}}return t}},{key:"getWorld",value:function(e){return k(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.parse(e),t.next=3,this.doParse(n);case 3:return r=t.sent,i=r.world,a=r.worldGenerationSettings,t.next=8,this.worldGenerator.populateWorld(i,a);case 8:return t.abrupt("return",i);case 9:case"end":return t.stop()}},t,this)}))}},{key:"doParse",value:function(e){return k(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,s,g,y,b,x,k,S,_,O,P,I,E,R,A,j,T;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(w(e.keys()).filter(function(t){return void 0!==e.get(t).find(function(e){return e.length>0})}).map(function(t){return[t,e.get(t)]})),n="",e.has("NAME")&&(a=e.get("NAME")[0],n=a.data.readString(a.length)),s=e.get("PLAYER4")[0],g=this.parsePlayers(s),y=e.has("INSEL5")?e.get("INSEL5"):[],t.next=8,this.parseIslands(y);case 8:return b=t.sent,x=this.handleBlock(e,"AUFTRAG4",d.taskFromSaveGame),k=this.handleBlock(e,"SHIP4",c.shipFromSaveGame),S=this.handleBlock(e,"SOLDAT3",l.soldierFromSaveGame),_=this.handleBlock(e,"KONTOR2",o.kontorFromSaveGame),O=this.handleBlock(e,"MILITAR",r.castleFromSaveGame),P=this.handleBlock(e,"STADT4",i.cityFromSaveGame),I=this.handleBlock(e,"PRODLIST2",u.producerFromSaveGame),E=null,e.has("HANDLER")&&e.get("HANDLER")[0].length>0&&(E=(0,h.traderFromSaveGame)(e.get("HANDLER")[0].data)),(0,v.default)(e.has("TIMERS")),(0,v.default)(1===e.get("TIMERS").length),R=(0,f.timersFromSaveGame)(e.get("TIMERS")[0].data),A=m.default.empty(),e.has("SZENE")&&(j=e.get("SZENE")[0].data,A=m.default.fromSaveGame(j)),T=new p.default(b,g,x,n,S,k,_,O,P,E,R,I),t.abrupt("return",{world:T,worldGenerationSettings:A});case 25:case"end":return t.stop()}},t,this)}))}},{key:"handleBlock",value:function(e,t,n){if(!e.has(t))return[];var r=[],i=!0,a=!1,o=void 0;try{for(var s,u=e.get(t)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)for(var c=s.value;!c.data.eof();)r.push(n(c.data))}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}},{key:"parseIslands",value:function(e){return k(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,s,u,c,l,d,f,h,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=!0,i=!1,o=void 0,t.prev=4,s=e[Symbol.iterator]();case 6:if(r=(u=s.next()).done){t.next=30;break}if(c=u.value,l=(0,a.islandFromSaveGame)(c.data),d=void 0!==c.inselHausBlocks?c.inselHausBlocks:[],f=g.Block.empty("INSELHAUS"),h=void 0,l.differsFromBaseIsland||!(d.length<=1)){t.next=21;break}return 1===d.length&&(f=d[0]),t.next=16,this.islandLoader.loadIslandFile(l);case 16:p=t.sent,g.Block.fromStream(p),h=g.Block.fromStream(p),t.next=24;break;case 21:(0,v.default)(d.length>=1&&d.length<=2),h=d[0],2===d.length&&(f=d[1]);case 24:l.baseFields=this.islandLoader.parseIslandBuildings(l,h),l.topFields=this.islandLoader.parseIslandBuildings(l,f),n.push(l);case 27:r=!0,t.next=6;break;case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(4),i=!0,o=t.t0;case 36:t.prev=36,t.prev=37,r||null==s.return||s.return();case 39:if(t.prev=39,!i){t.next=42;break}throw o;case 42:return t.finish(39);case 43:return t.finish(36);case 44:return t.abrupt("return",n);case 45:case"end":return t.stop()}},t,this,[[4,32,36,44],[37,,39,43]])}))}},{key:"parsePlayers",value:function(e){for(var t=[];!e.data.eof();)t.push((0,s.playerFromSaveGame)(e.data));return t}}])&&x(t.prototype,n),b&&x(t,b),e}();t.default=S},P9xW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("EVan")),i=a(n("8si9"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},c=function(){function e(t,n,r,i,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.gamParser=n,this.islandRenderer=r,this.viewport=i,this.configLoader=a,this.musicPlayer=o}var t,n,a;return t=e,(n=[{key:"loadByName",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSavesAndMissions();case 2:return t.t0=function(t){return t.name===e},n=t.sent.find(t.t0),t.next=6,this.load(n);case 6:case"end":return t.stop()}},t,this)}))}},{key:"load",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.openAndGetContentAsStream(e);case 2:return n=t.sent,t.next=5,this.gamParser.getWorld(n);case 5:return a=t.sent,o=new i.default(a,this.islandRenderer,this.viewport),s=new r.default(o,this.configLoader),t.next=10,s.begin(a);case 10:this.musicPlayer.playAll();case 11:case"end":return t.stop()}},t,this)}))}},{key:"loadSavesAndMissions",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.t0=t.push,e.t1=t,e.t2=o,e.next=7,this.fs.ls("/saves",".gam");case 7:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),e.next=14;break;case 12:e.prev=12,e.t5=e.catch(1);case 14:return n=[],e.prev=15,e.t6=n.push,e.t7=n,e.t8=o,e.next=21,this.fs.ls("/missions-original",".szs|.szm");case 21:return e.t9=e.sent,e.t10=(0,e.t8)(e.t9),e.t6.apply.call(e.t6,e.t7,e.t10),e.t11=n.push,e.t12=n,e.t13=o,e.next=29,this.fs.ls("/missions-custom",".szs|.szm");case 29:e.t14=e.sent,e.t15=(0,e.t13)(e.t14),e.t11.apply.call(e.t11,e.t12,e.t15),e.next=36;break;case 34:e.prev=34,e.t16=e.catch(15);case 36:return e.abrupt("return",t.concat(n));case 37:case"end":return e.stop()}},e,this,[[1,12],[15,34]])}))}}])&&s(t.prototype,n),a&&s(t,a),e}();t.default=c},PWAz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IslandBlock=t.Block=void 0;var r,i=(r=n("cE7O"))&&r.__esModule?r:{default:r};function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,n,r){c(this,e),this.type=t,this.length=n,this.data=new i.default(r.slice(n))}var t,n,r;return t=e,r=[{key:"empty",value:function(t){return new e(t,0,new i.default(new Uint8Array))}},{key:"fromStream",value:function(t){return new e(t.readString(16),t.read32(),t)}}],(n=null)&&l(t.prototype,n),r&&l(t,r),e}();t.Block=d;var f=function(e){function t(){var e;return c(this,t),(e=o(this,s(t).apply(this,arguments))).inselHausBlocks=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,d),t}();t.IslandBlock=f},"S+oN":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traderFromSaveGame=function(e){var t=e.read32(),n=e.read(20),r=function(e){for(var t=[],n=0;n<24;n++)t.push({goodId:e.read32(),_1:e.read32(),_2:e.read32()});return t}(e),i=e.read(292);return console.error(t,n,r,i),{goods:r}}},T7bp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("vurl");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=n("1Y70"),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,(n=[{key:"createBitmapFont",value:function(e,t){return a(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,a,s,u,c,l,d,f,h,p,m;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(i=[],a=[],s=0;s<e.length;s++)for(u=e[s],i.push({page:[{_attr:{id:s,file:"data:image/png;base64,".concat((0,r.uInt8ToBase64)(new Uint8Array(u.png)))}}]}),c=Object.keys(u.config.frames),l=0;l<c.length;l++)d=c[l],f=u.config.frames[d],h=parseInt(d,10)+32,a.push({char:[{_attr:{id:h,x:f.frame.x,y:f.frame.y,width:f.frame.w,height:f.frame.h,xoffset:0,yoffset:0,xadvance:f.frame.w,page:s,chnl:15,letter:String.fromCharCode(h)}}]});return p=e[0].config.frames[0].sourceSize.h,m={font:[{info:[{_attr:{face:t,size:p,padding:"0,0,0,0",spacing:"0,0",italic:"0",bold:"0",stretchH:"100",smooth:"1",aa:"1"}}]},{common:[{_attr:{pages:e.length,lineHeight:p,packed:0}}]},{pages:i},{chars:a}]},n.abrupt("return",o(m,{indent:"  "}));case 6:case"end":return n.stop()}},n,this)}))}}])&&i(t.prototype,n),s&&i(t,s),e}();t.default=s},Uaxg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),i=o(n("lXCB")),a=o(n("+NJT"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stage=t,this.spriteLoader=n,this.videos=[]}var t,n,o;return t=e,(n=[{key:"render",value:function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,s,u,c,l,d,f,h,p,m,v,g=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(this.destroyVideos(),this.stage.removeChildren(),o=new Map,s=Object.keys(e.variables),u=0;u<s.length;u++)c=s[u],l=e.variables[c],c.startsWith("BLK_")&&o.set(l,c.substring(4));d=[],f=0,h=e.objects.GADGET.items,p=Object.keys(h),m=regeneratorRuntime.mark(function e(){var n,s,u,c,l,m,y,b,w,x,k,S,_,O,P,I,E,R,A,j,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=p[v],s=h[n],u=s.Id,c=s.Blocknr,l=s.Gfxnr,m=s.Kind,y=new r.Point(s.Pos[0],s.Pos[1]),s.Posoffs&&y.set(y.x+s.Posoffs[0],y.y+s.Posoffs[1]),b=void 0!==s.Size?new r.Point(s.Size.x,s.Size.y):null,w=void 0===s.Noselflg||0===s.Noselflg,x=s.Pressoff,(k=1===s.Reiheflg)&&(0,i.default)(w),(0,i.default)(void 0!==c),S=void 0!==s.Slidverflg,_=s.Slidoffs,O=s.Slidsize,e.t0=m,e.next="GAD_GFX"===e.t0?20:"GAD_TEXTL"===e.t0?32:40;break;case 20:return e.next=22,g.spriteLoader.getTextures("TOOLS/".concat(o.get(c)));case 22:return P=e.sent,I=P.get(l),E=P.get(l+x),(R=S?new a.default(I):new r.Sprite(I)).position.set(y.x,y.y),R.name="menu-".concat(u),S&&R.setSliderData(b.y,_[1],O[1]),w&&(R.buttonMode=!0,R.interactive=!0,A=t.buttons[f],k&&(0===d.length&&(R.texture=E),d.push({sprite:R,activeTexture:E,defaultTexture:I})),R.on("mousedown",function(){if(R.texture=E,k)for(var e=0;e<d.length;e++){var t=d[e];t.sprite!==R&&(t.sprite.texture=t.defaultTexture)}A(g.stage)}),k||R.on("mouseup",function(){return R.texture=I}),f++),g.stage.addChild(R),e.abrupt("break",41);case 32:return j=24,(T=new r.extras.BitmapText("Here goes text!",{font:{name:"ZEI20V",size:j}})).position.set(y.x,y.y),T.pivot.set(0,j),T.name="menu-".concat(u),T.hitArea=new r.Rectangle(0,0,b.x,b.y),g.stage.addChild(T),e.abrupt("break",41);case 40:console.warn("Unsupported kind: ".concat(m));case 41:case"end":return e.stop()}},e,this)}),v=0;case 11:if(!(v<p.length)){n.next=16;break}return n.delegateYield(m(),"t0",13);case 13:v++,n.next=11;break;case 16:return n.next=18,t.onLoad(this.stage);case 18:case"end":return n.stop()}},n,this)}))}},{key:"renderVideo",value:function(e,t){var n=this;e.texture.baseTexture.source.addEventListener("ended",function(){n.stage.removeChild(e),t()},{once:!0}),this.stage.addChild(e),this.videos.push(e)}},{key:"renderVideoFullscreen",value:function(e,t){var n=this;this.destroyVideos(),this.stage.removeChildren(),e.texture.baseTexture.source.addEventListener("ended",function(){n.stage.removeChild(e),t()},{once:!0}),e.scale.set(2,2);var r=512-e.texture.width*e.scale.x/2,i=384-e.texture.height*e.scale.y/2;e.position.set(r,i),this.stage.addChild(e)}},{key:"destroyVideos",value:function(){this.videos.forEach(function(e){return e.destroy({texture:!0,baseTexture:!0})}),this.videos=[]}}])&&s(t.prototype,n),o&&s(t,o),e}();t.default=c},UpaQ:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SimulationSpeed=void 0,t.SimulationSpeed=r,function(e){e[e.Paused=0]="Paused",e[e.Default=1]="Default",e[e.Slow=1]="Slow",e[e.Medium=2]="Medium",e[e.Fast=4]="Fast",e[e.SuperFast=8]="SuperFast"}(r||(t.SimulationSpeed=r={}));t.default=function e(t,n,r,i,a,o,s,u,c,l,d,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.islands=t,this.players=n,this.tasks=r,this.gameName=i,this.soldiers=a,this.ships=o,this.kontors=s,this.castles=u,this.cities=c,this.trader=l,this.timers=d,this.producers=f,console.table(r),console.log(i),console.table(t),console.table(n),console.table(a),console.table(o),console.table(s),console.table(u),console.table(c),console.log(l),console.log(d),console.table(f)}},Wxsv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timersFromSaveGame=function(e){var t=e.read8(),n=e.read8(),r=e.read8(),a=e.read8(),o=e.read8();(0,i.default)(e.read(63).every(function(e){return 0===e}));var s=e.read(32),u=e.read(32),c=e.read32(),l=e.read32(),d=e.read32(),f=e.read32(),h=e.read32(),p=e.read32(),m=e.read32(),v=e.read32(),g=e.read8(),y=e.read8(),b=e.read8(),w=e.read8(),x=e.read32(),k=0==(64&x),S=0==(8&x),_=0==(4&x),O=0==(1&x),P=0==(256&x),I=e.read32(),E=e.read32(),R=e.read32(),A=e.read32(),j=e.read32(),T=e.read32();e.read(4),e.read(4);var C=e.read32(),M=e.read32();e.read(49,4);var G=e.read(32,4),N=e.read(32,4),F={cntCity:t,cntIsland:n,cntShipyard:r,cntMilitary:a,cntProduction:o,cntSettlers:s,cntGrowth:u,timeCity:c,timeIsland:l,timeShipyard:d,timeMilitary:f,timeProduction:h,timeGoodToolsCnt:p,timeGoodToolsMax:m,timeGame:v,noErzOutFlg:g,tutorFlg:y,aiLevel:b,missionNumber:w,gameId:I,cityNameNumber:E,timeNextDrought:R,timePirateSec:A,missionSubNumber:j,shipMax:T,timeNextVulcano:C,cntVulcano:M,timeSettlers:G,timeGrowth:N,enableTrader:k,bigIronRunsOut:S,enableDroughts:_,enablePirate:O,enableVulcano:P};return console.log(F),F};var r,i=(r=n("lXCB"))&&r.__esModule?r:{default:r}},"Y+Un":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),a=n("xFL8"),o=(r=n("5FwS"))&&r.__esModule?r:{default:r};function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var f=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},h=function(e){function t(e,n,r){var i,a,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,u=c(t).call(this),(i=!u||"object"!==s(u)&&"function"!=typeof u?d(a):u).fs=e,i.gadRenderer=n,i.musicPlayer=r,i.structure={menu_main:{onLoad:function(){return i._playMainMenuMusic()},buttons:[function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.renderScreen("menu_missions"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Multiplayer"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.musicPlayer.stop(),e.next=3,this.loadVideoSprite(10);case 3:(t=e.sent).width=439,t.height=353,t.position.set(507,366),this.gadRenderer.renderVideo(t,function(){return n._playMainMenuMusic});case 8:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadVideoSprite(58);case 2:t=e.sent,this.musicPlayer.stop(),this.gadRenderer.renderVideoFullscreen(t,function(){return n.renderScreen("menu_main")});case 5:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Exit"));case 1:case"end":return e.stop()}},e,this)}))}]},menu_missions:new o.default(i.fs,d(d(i))),menu_loading:{onLoad:function(){},buttons:[]},menu_mission_details:{onLoad:function(){},buttons:[function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Start Mission"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.renderScreen("menu_missions"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Highscores up"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Highscores down"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Sub-Mission 0"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Sub-Mission 1"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Sub-Mission 2"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Sub-Mission 3"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Sub-Mission 4"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Mission Description up"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Mission Description down"));case 1:case"end":return e.stop()}},e,this)}))},function(){return f(d(d(i)),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("Mission Description Slider"));case 1:case"end":return e.stop()}},e,this)}))}]}},i}var n,r,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i.utils.EventEmitter),n=t,(r=[{key:"renderScreen",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,this.fs.openAndGetContentAsText("/screens/".concat(e,".json"));case 3:return t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),console.log(n),r=this.structure[e],t.next=9,this.gadRenderer.render(n,r);case 9:case"end":return t.stop()}},t,this)}))}},{key:"_playMainMenuMusic",value:function(){this.musicPlayer.play("1st Beginning",!0)}},{key:"loadVideoSprite",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fs.openAndGetContentAsUint8Array("/videos/".concat(e,".mp4"));case 2:return n=t.sent,t.next=5,(0,a.textureFromUint8ArrayMP4)(n);case 5:return r=t.sent,t.abrupt("return",i.Sprite.from(r));case 7:case"end":return t.stop()}},t,this)}))}}])&&u(n.prototype,r),h&&u(n,h),t}();t.default=h},Y5Uv:function(e,t,n){"use strict";var r,i,a,o,s,u,c,l,d,f,h,p,m,v,g,y,b,w,x,k,S,_,O;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,function(e){e[e["menu.divider.orginal_missions"]=85]="menu.divider.orginal_missions",e[e["menu.divider.missions"]=86]="menu.divider.missions",e[e["menu.divider.new_missions"]=87]="menu.divider.new_missions",e[e["menu.divider.custom_missions"]=88]="menu.divider.custom_missions",e[e.exit_game=89]="exit_game",e[e.exit_game_question=90]="exit_game_question"}(r||(r={})),i||(i={}),function(e){e[e["player.color.red"]=0]="player.color.red",e[e["player.color.blue"]=1]="player.color.blue",e[e["player.color.yellow"]=2]="player.color.yellow",e[e["player.color.white"]=3]="player.color.white"}(a||(a={})),function(e){e[e["videos.event"]=0]="videos.event",e[e["videos.battle"]=1]="videos.battle",e[e["videos.diplomacy"]=2]="videos.diplomacy"}(o||(o={})),function(e){e[e["speech.event"]=0]="speech.event",e[e["speech.island_status"]=1]="speech.island_status",e[e["speech.player"]=2]="speech.player",e[e["speech.trade"]=3]="speech.trade",e[e["speech.battle"]=4]="speech.battle",e[e["speech.order"]=5]="speech.order",e[e["speech.diplomacy"]=6]="speech.diplomacy"}(s||(s={})),function(e){e[e["path.custom_missions"]=0]="path.custom_missions"}(u||(u={})),function(e){e[e["endless.difficulty.easy"]=0]="endless.difficulty.easy",e[e["endless.difficulty.medium"]=1]="endless.difficulty.medium",e[e["endless.difficulty.difficult"]=2]="endless.difficulty.difficult",e[e["endless.difficulty.hard"]=3]="endless.difficulty.hard"}(c||(c={})),function(e){e[e["tutorial.mission_0"]=0]="tutorial.mission_0",e[e["tutorial.mission_1"]=1]="tutorial.mission_1",e[e["tutorial.mission_2"]=2]="tutorial.mission_2",e[e["tutorial.mission_3"]=3]="tutorial.mission_3",e[e["tutorial.mission_4"]=4]="tutorial.mission_4"}(l||(l={})),function(e){e[e["campaign.0.mission_0"]=0]="campaign.0.mission_0",e[e["campaign.0.mission_1"]=1]="campaign.0.mission_1",e[e["campaign.0.mission_2"]=2]="campaign.0.mission_2",e[e["campaign.0.mission_3"]=3]="campaign.0.mission_3",e[e["campaign.0.mission_4"]=4]="campaign.0.mission_4",e[e["campaign.1.mission_0"]=5]="campaign.1.mission_0",e[e["campaign.1.mission_1"]=6]="campaign.1.mission_1",e[e["campaign.1.mission_2"]=7]="campaign.1.mission_2",e[e["campaign.1.mission_3"]=8]="campaign.1.mission_3",e[e["campaign.1.mission_4"]=9]="campaign.1.mission_4",e[e["campaign.2.mission_0"]=10]="campaign.2.mission_0",e[e["campaign.2.mission_1"]=11]="campaign.2.mission_1",e[e["campaign.2.mission_2"]=12]="campaign.2.mission_2",e[e["campaign.2.mission_3"]=13]="campaign.2.mission_3",e[e["campaign.2.mission_4"]=14]="campaign.2.mission_4",e[e["campaign.3.mission_0"]=15]="campaign.3.mission_0",e[e["campaign.3.mission_1"]=16]="campaign.3.mission_1",e[e["campaign.3.mission_2"]=17]="campaign.3.mission_2",e[e["campaign.3.mission_3"]=18]="campaign.3.mission_3",e[e["campaign.3.mission_4"]=19]="campaign.3.mission_4",e[e["campaign.4.mission_0"]=20]="campaign.4.mission_0",e[e["campaign.4.mission_1"]=21]="campaign.4.mission_1",e[e["campaign.4.mission_2"]=22]="campaign.4.mission_2",e[e["campaign.4.mission_3"]=23]="campaign.4.mission_3",e[e["campaign.4.mission_4"]=24]="campaign.4.mission_4",e[e["campaign.5.mission_0"]=25]="campaign.5.mission_0",e[e["campaign.5.mission_1"]=26]="campaign.5.mission_1",e[e["campaign.5.mission_2"]=27]="campaign.5.mission_2",e[e["campaign.5.mission_3"]=28]="campaign.5.mission_3",e[e["campaign.5.mission_4"]=29]="campaign.5.mission_4"}(d||(d={})),function(e){e[e["figure.unused"]=0]="figure.unused",e[e["figure.infantry"]=1]="figure.infantry",e[e["figure.cavalry"]=2]="figure.cavalry",e[e["figure.musketeer"]=3]="figure.musketeer",e[e["figure.artiellery"]=4]="figure.artiellery"}(f||(f={})),function(e){e[e["good.empty"]=0]="good.empty",e[e["good.each"]=1]="good.each",e[e["good.iron_ore"]=2]="good.iron_ore",e[e["good.gold_ore"]=3]="good.gold_ore",e[e["good.wool"]=4]="good.wool",e[e["good.sugarcane"]=5]="good.sugarcane",e[e["good.tobacco"]=6]="good.tobacco",e[e["good.cattle"]=7]="good.cattle",e[e["good.grain"]=8]="good.grain",e[e["good.flour"]=9]="good.flour",e[e["good.iron"]=10]="good.iron",e[e["good.swords"]=11]="good.swords",e[e["good.muskets"]=12]="good.muskets",e[e["good.cannons"]=13]="good.cannons",e[e["good.food"]=14]="good.food",e[e["good.tobacco_products"]=15]="good.tobacco_products",e[e["good.spices"]=16]="good.spices",e[e["good.cocoa"]=17]="good.cocoa",e[e["good.liquor"]=18]="good.liquor",e[e["good.cloth"]=19]="good.cloth",e[e["good.clothes"]=20]="good.clothes",e[e["good.jewlry"]=21]="good.jewlry",e[e["good.tools"]=22]="good.tools",e[e["good.wood"]=23]="good.wood",e[e["good.bricks"]=24]="good.bricks"}(h||(h={})),function(e){e[e["rohst.grain"]=0]="rohst.grain",e[e["rohst.tobacco"]=1]="rohst.tobacco",e[e["rohst.spices"]=2]="rohst.spices",e[e["rohst.sugarcane"]=3]="rohst.sugarcane",e[e["rohst.cotton"]=4]="rohst.cotton",e[e["rohst.vines"]=5]="rohst.vines",e[e["rohst.cocoa"]=6]="rohst.cocoa",e[e["rohst.grazing_land"]=7]="rohst.grazing_land",e[e["rohst.tree"]=8]="rohst.tree",e[e["rohst.stones"]=9]="rohst.stones",e[e["rohst.ores"]=10]="rohst.ores",e[e["rohst.wild_game"]=11]="rohst.wild_game",e[e["rohst.fish"]=12]="rohst.fish"}(p||(p={})),function(e){e[e["rohst_field.grain"]=0]="rohst_field.grain",e[e["rohst_field.tobacco"]=1]="rohst_field.tobacco",e[e["rohst_field.spices"]=2]="rohst_field.spices",e[e["rohst_field.sugarcane"]=3]="rohst_field.sugarcane",e[e["rohst_field.cotton"]=4]="rohst_field.cotton",e[e["rohst_field.vines"]=5]="rohst_field.vines",e[e["rohst_field.cocoa"]=6]="rohst_field.cocoa",e[e["rohst_field.grazing_land"]=7]="rohst_field.grazing_land",e[e["rohst_field.tree"]=8]="rohst_field.tree",e[e["rohst_field.stones"]=9]="rohst_field.stones",e[e["rohst_field.ores"]=10]="rohst_field.ores",e[e["rohst_field.wild_game"]=11]="rohst_field.wild_game",e[e["rohst_field.fish"]=12]="rohst_field.fish"}(m||(m={})),function(e){e[e["buildings.military.wooden.wall"]=0]="buildings.military.wooden.wall",e[e["buildings.military.wooden.gate"]=1]="buildings.military.wooden.gate",e[e["buildings.military.wooden.watchtower"]=2]="buildings.military.wooden.watchtower",e[e["buildings.military.stone.wall"]=3]="buildings.military.stone.wall",e[e["buildings.military.stone.gate"]=4]="buildings.military.stone.gate",e[e["buildings.military.stone.watchtower"]=5]="buildings.military.stone.watchtower",e[e["buildings.military.stone.gate_big"]=6]="buildings.military.stone.gate_big",e[e["buildings.military.castle.small"]=7]="buildings.military.castle.small",e[e["buildings.military.castle.medium"]=8]="buildings.military.castle.medium",e[e["buildings.military.castle.large"]=9]="buildings.military.castle.large"}(v||(v={})),function(e){e[e["buildings.house.house"]=0]="buildings.house.house"}(g||(g={})),function(e){e[e["buildings.street.dirt.street"]=0]="buildings.street.dirt.street",e[e["buildings.street.stone.street"]=1]="buildings.street.stone.street",e[e["buildings.street.dirt.bridge"]=2]="buildings.street.dirt.bridge",e[e["buildings.street.stone.bridge"]=3]="buildings.street.stone.bridge",e[e["buildings.street.square.0"]=4]="buildings.street.square.0",e[e["buildings.street.square.1"]=5]="buildings.street.square.1",e[e["buildings.street.square.2"]=6]="buildings.street.square.2",e[e["buildings.street.square.3"]=7]="buildings.street.square.3"}(y||(y={})),function(e){e[e["buildings.mine.quarry"]=0]="buildings.mine.quarry",e[e["buildings.mine.iron"]=1]="buildings.mine.iron",e[e["buildings.mine.iron_deep"]=2]="buildings.mine.iron_deep",e[e["buildings.mine.gold"]=3]="buildings.mine.gold"}(b||(b={})),function(e){e[e["buildings.production.weaver"]=0]="buildings.production.weaver",e[e["buildings.production.butcher"]=1]="buildings.production.butcher",e[e["buildings.production.flour_mill"]=2]="buildings.production.flour_mill",e[e["buildings.production.bakery"]=3]="buildings.production.bakery",e[e["buildings.production.tobacco"]=4]="buildings.production.tobacco",e[e["buildings.production.distillery"]=5]="buildings.production.distillery",e[e["buildings.production.tailor"]=6]="buildings.production.tailor",e[e["buildings.production.weaving_mill"]=7]="buildings.production.weaving_mill",e[e["buildings.production.stonemason"]=8]="buildings.production.stonemason",e[e["buildings.production.water_mill"]=9]="buildings.production.water_mill",e[e["buildings.production.ore_smelter"]=10]="buildings.production.ore_smelter",e[e["buildings.production.tool_maker"]=11]="buildings.production.tool_maker",e[e["buildings.production.gold_smith"]=12]="buildings.production.gold_smith",e[e["buildings.production.armourer"]=13]="buildings.production.armourer",e[e["buildings.production.musket_maker"]=14]="buildings.production.musket_maker",e[e["buildings.production.canon_foundry"]=15]="buildings.production.canon_foundry"}(w||(w={})),function(e){e[e["buildings.farm.hunter"]=0]="buildings.farm.hunter",e[e["buildings.farm.forester"]=1]="buildings.farm.forester",e[e["buildings.field.forest"]=2]="buildings.field.forest",e[e["buildings.farm.grain"]=3]="buildings.farm.grain",e[e["buildings.field.grain"]=4]="buildings.field.grain",e[e["buildings.farm.sheep"]=5]="buildings.farm.sheep",e[e["buildings.farm.cattle"]=6]="buildings.farm.cattle",e[e["buildings.farm.tobacco"]=7]="buildings.farm.tobacco",e[e["buildings.field.tobacco"]=8]="buildings.field.tobacco",e[e["buildings.farm.spice"]=9]="buildings.farm.spice",e[e["buildings.field.spice"]=10]="buildings.field.spice",e[e["buildings.farm.wine"]=11]="buildings.farm.wine",e[e["buildings.field.wine"]=12]="buildings.field.wine",e[e["buildings.farm.sugarcane"]=13]="buildings.farm.sugarcane",e[e["buildings.field.sugarcane"]=14]="buildings.field.sugarcane",e[e["buildings.farm.cotton"]=15]="buildings.farm.cotton",e[e["buildings.field.cotton"]=16]="buildings.field.cotton",e[e["buildings.farm.cocoa"]=17]="buildings.farm.cocoa",e[e["buildings.field.cocoa"]=18]="buildings.field.cocoa"}(x||(x={})),function(e){e[e["buildings.docks.warehouse.0"]=0]="buildings.docks.warehouse.0",e[e["buildings.docks.warehouse.1"]=1]="buildings.docks.warehouse.1",e[e["buildings.docks.warehouse.2"]=2]="buildings.docks.warehouse.2",e[e["buildings.docks.warehouse.3"]=3]="buildings.docks.warehouse.3",e[e["buildings.docks.fisher"]=4]="buildings.docks.fisher",e[e["buildings.docks.dock"]=5]="buildings.docks.dock",e[e["buildings.docks.shipyard.small"]=6]="buildings.docks.shipyard.small",e[e["buildings.docks.shipyard.large"]=7]="buildings.docks.shipyard.large"}(k||(k={})),function(e){e[e["buildings.public.house"]=0]="buildings.public.house",e[e["buildings.public.marketplace"]=1]="buildings.public.marketplace",e[e["buildings.public.chapel"]=2]="buildings.public.chapel",e[e["buildings.public.church"]=3]="buildings.public.church",e[e["buildings.public.cathedral"]=4]="buildings.public.cathedral",e[e["buildings.public.tavern"]=5]="buildings.public.tavern",e[e["buildings.public.doctor"]=6]="buildings.public.doctor",e[e["buildings.public.school"]=7]="buildings.public.school",e[e["buildings.public.college"]=8]="buildings.public.college",e[e["buildings.public.bathhouse"]=9]="buildings.public.bathhouse",e[e["buildings.public.theater"]=10]="buildings.public.theater",e[e["buildings.public.firefighters"]=11]="buildings.public.firefighters",e[e["buildings.public.palace"]=12]="buildings.public.palace",e[e["buildings.public.gallows"]=13]="buildings.public.gallows",e[e["buildings.public.monument"]=14]="buildings.public.monument",e[e["buildings.public.triumphal_arch"]=15]="buildings.public.triumphal_arch"}(S||(S={})),function(e){e[e.demolish=0]="demolish"}(_||(_={})),function(e){e[e["natives.0.head_lodge"]=0]="natives.0.head_lodge",e[e["natives.0.hut.0"]=1]="natives.0.hut.0",e[e["natives.0.hut.1"]=2]="natives.0.hut.1",e[e["natives.0.hut.2"]=3]="natives.0.hut.2",e[e["natives.0.hut.3"]=4]="natives.0.hut.3",e[e["natives.1.head_lodge"]=5]="natives.1.head_lodge",e[e["natives.1.hut.0"]=6]="natives.1.hut.0",e[e["natives.1.hut.1"]=7]="natives.1.hut.1",e[e["natives.1.hut.2"]=8]="natives.1.hut.2",e[e["natives.1.hut.3"]=9]="natives.1.hut.3",e[e["natives.pyramid"]=10]="natives.pyramid",e[e["pirates.warehouse"]=11]="pirates.warehouse",e[e["pirates.1"]=12]="pirates.1",e[e["pirates.2"]=13]="pirates.2",e[e["pirates.tower"]=14]="pirates.tower",e[e["forest.mixed"]=15]="forest.mixed",e[e["forest.palm"]=16]="forest.palm"}(O||(O={}));var P={GAME:r,LEISTE:i,PATH:u,ENDLESSKIND:c,PLAYCOL:a,VIDEOKIND:o,SPEECHKIND:s,TUTORKIND:l,KAMPAGNE:d,FIGKIND:f,WARE:h,ROHST:p,ROHSTFELD:m,MILITAR:v,WOHNHAUS:g,STRASSE:y,BERGWERK:b,HANDWERK:w,FARM:x,HAFEN:k,DIVERS:S,ABRISS:_,LANDSCHAFT:O};t.default=P},"a/P+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return o.get(e)},t.loadTranslations=function(e){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a,s,u,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,e.openAndGetContentAsText("/translations.json");case 3:for(t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),r=Object.keys(n),a=0;a<r.length;a++)for(c in s=r[a],u=i.default[s])parseInt(c,10)>=0&&(l=u[c],o.set(l,n[s][c]));case 7:case"end":return t.stop()}},t,this)}))};var r,i=(r=n("Y5Uv"))&&r.__esModule?r:{default:r};var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=new Map},bmue:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShipCourse=t.CourseState=void 0;var r,i,a=(r=n("lXCB"))&&r.__esModule?r:{default:r};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.CourseState=i,function(e){e[e.Stopped=0]="Stopped",e[e.Sailing=55]="Sailing",e[e.Unknown=53]="Unknown",e[e.Unknown2=52]="Unknown2",e[e.Unknown3=54]="Unknown3",e[e.Unknown4=51]="Unknown4"}(i||(t.CourseState=i={}));var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.position=t,this.state=n}var t,n,r;return t=e,r=[{key:"fromSaveGame",value:function(t){var n=t.read32(),r=n>>8&255,o=n>>16&255,s=n>>24&255,u=n>>0&255;return(0,a.default)(u in i),new e(new PIXI.Point(s+((15&r)<<8),o+((240&r)<<4)),u)}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.ShipCourse=s},cE7O:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=0,this.data=t}return i(e,null,[{key:"fromZipObject",value:function(t){return a(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.async("uint8array");case 2:return r=n.sent,n.abrupt("return",new e(r));case 4:case"end":return n.stop()}},n,this)}))}}]),i(e,[{key:"position",value:function(){return this.pos}},{key:"seek",value:function(e){this.pos=e}},{key:"readString",value:function(e){for(var t="",n=!1;e--;){var r=this.read8();n||0===r?n=!0:t+=String.fromCharCode(r)}return t}},{key:"readStringUnterminated",value:function(e){for(var t="";e--;)t+=String.fromCharCode(this.read8());return t}},{key:"read",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e*=t;for(var n=[];e>0;)n.push(this.readNBytes(t)),e-=t;return n}},{key:"slice",value:function(e){var t=this.data.slice(this.pos,this.pos+e);return this.pos+=e,t}},{key:"read16",value:function(){return this.readNBytes(2)}},{key:"read24",value:function(){return this.readNBytes(3)}},{key:"read32",value:function(){return this.readNBytes(4)}},{key:"read32S",value:function(){return this.readNBytes(4)>>0}},{key:"read64",value:function(){return this.readNBytes(8)}},{key:"read8",value:function(){return this.data[this.pos++]}},{key:"eof",value:function(){return this.pos===this.length}},{key:"read8Bool",value:function(){return 0!==this.read8()}},{key:"readNBytes",value:function(e){for(var t=0,n=0;n<e;n++)t+=this.read8()*Math.pow(2,8*n);return t}},{key:"length",get:function(){return this.data.length}}]),e}();t.default=o},daKf:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=n("rPnE"),a=(r=n("cE7O"))&&r.__esModule?r:{default:r};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.encoding="win1252"}var n,r,s;return n=t,(r=[{key:"decrypt",value:function(t){for(var n=new e(t.length),r=0;r<t.length;r++)n[r]=256-t.read8();return(0,i.decode)(n,this.encoding)}},{key:"encrypt",value:function(t){for(var n=new a.default((0,i.encode)(t,this.encoding)),r=new e(n.length),o=0;o<n.length;o++)r[o]=256-n.read8();return r}}])&&o(n.prototype,r),s&&o(n,s),t}();t.default=s}).call(this,n("tjlA").Buffer)},e48e:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.producerFromSaveGame=function(e){var t=e.read8(),n=new PIXI.Point(e.read8(),e.read8()),r=e.read8(),a=e.read8(),o=e.read24(),s=e.read16(),u=e.read16(),c=e.read24(),l=e.read8(),d=e.read16(),f=e.read16(),h=e.read8(),p=(1&h)>0,m=(2&h)>0,v=h>>2&15,g=0==(64&h),y=15&e.read8();return(0,i.default)(0===e.read16()),{islandId:t,position:n,speed:r,speedCount:a,stock:o,timer:s,secondGoodStock:u,firstGoodStock:c,producedGood:l,prodCnt:d,timeCnt:f,active:p,connectedToMarket:m,animCnt:v,allowGoodPickup:g,noGoodCnt:y}};var r,i=(r=n("lXCB"))&&r.__esModule?r:{default:r}},fqKA:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(t,n,r,i,a,o,s,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fieldId=t,this.x=n,this.y=r,this.islandId=i,this.islandCityNum=a,this.rotation=o,this.ani=s,this.random=u,this.playerId=c}var t,n,i;return t=e,i=[{key:"fromSaveGame",value:function(t){var n=t.read16()+2e4,r=t.read8(),i=t.read8(),a=t.read32(),o=a>>0&Math.pow(2,2)-1,s=a>>2&Math.pow(2,4)-1,u=a>>6&Math.pow(2,8)-1,c=a>>14&Math.pow(2,3)-1,l=a>>17&Math.pow(2,5)-1,d=a>>22&Math.pow(2,4)-1;Math.pow(2,6);return new e(n,r,i,u,c,o,s,l,d)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.default=i,i.saveGameDataLength=8},gn45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("/dzE");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"parse",value:function(e){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.loadFFmpeg)();case 2:return this.ffmpeg=t.sent,n=[{data:e,name:"input.smk"}],t.prev=4,i=this.prepareArguments(!0),t.next=8,this.convert(i,n);case 8:return t.abrupt("return",t.sent);case 11:if(t.prev=11,t.t0=t.catch(4),"only-one-audio-stream"!==t.t0.message){t.next=26;break}return t.prev=14,a=this.prepareArguments(!1),t.next=18,this.convert(a,n);case 18:return t.abrupt("return",t.sent);case 21:throw t.prev=21,t.t1=t.catch(14),t.t1;case 24:t.next=27;break;case 26:throw t.t0;case 27:case"end":return t.stop()}},t,this,[[4,11],[14,21]])}))}},{key:"prepareArguments",value:function(e){var t=["-i","input.smk"];return e&&t.push.apply(t,["-filter_complex","[0:a]amerge[c]","-map","[c]","-map","0:v:0"]),t.push.apply(t,["-ac","2","-c:v","libx264","-pix_fmt","yuv420p","-preset","ultrafast","-movflags","+faststart","output.mp4"]),t}},{key:"convert",value:function(e,t){return a(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("Converting video with arguments ".concat(e.join(" "))),n.abrupt("return",new Promise(function(n,i){var a="",o=function(e){a+=e+"\n",console.log(e)};r.ffmpeg({arguments:e,files:t,print:o,printErr:o,stdin:function(){},TOTAL_MEMORY:1e8,returnCallback:function(e){a.includes("Cannot find a matching stream for unlabeled input pad 1")?i(new Error("only-one-audio-stream")):1!==e.length?i(new Error("unknown-error")):n(new Uint8Array(e[0].data))}})}));case 2:case"end":return n.stop()}},n,this)}))}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=o},hD6V:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playerFromSaveGame=function(e){var t=e.read32S(),n=e.read8(),r=e.read8(),s=(e.read8(),e.read8()),u=e.read8();(0,i.default)(0===e.read8());var c=e.read16(),l=e.read8(),d=e.read8(),f=e.read8Bool(),h=e.read8Bool(),p=e.read16(),m=e.read16(),v=e.read16(),g=e.read16(),y=e.read16(),b=e.read16(),w=e.read8(),x=e.read8(),k=(1&x)>0,S=(2&x)>0,_=e.read(6),O=e.read8()/32+1,P=e.read8()/32+1;(0,i.default)(e.read(14).every(function(e){return 0===e}));var I=e.read32(),E=e.read16(),R=e.read16(),A=e.read32();(0,i.default)(4294967295===A);e.read(264);for(var j=[],T=0;T<3;T++)j.push(a.default.fromSaveGame(e));for(var C=[],M=0;M<3;M++)C.push(a.default.fromSaveGame(e));e.read(72);for(var G=[],N=0;N<64;N++)G.push(o.default.fromSaveGame(e));var F=e.readString(64),D=e.readString(48);return console.log("player ".concat(r,":  "),u,c,d,w,_),{id:r,kind:n,color:s,fullName:F,shortName:D,tradeContracts:j,peaceContracts:C,money:t,enemiesDefeated:p,triumphArchesBuilt:m,soldiersKilled:v,soldiersFallen:g,shipsSunken:y,shipsKilled:b,accessibleBuildings:I,statues:E,statuesBuilt:R,palaceBuilt:f,cathedralBuilt:h,enablePositiveWillInfluence:k,enableNegativeWillInfluence:S,positiveWillInfluence:O,negativeWillInfluence:P,assignedTaskId:l,playerEvents:G}},t.PlayerKind=void 0;var r,i=s(n("lXCB")),a=s(n("BdDv")),o=s(n("Iu1z"));function s(e){return e&&e.__esModule?e:{default:e}}t.PlayerKind=r,function(e){e[e.HUMAN=0]="HUMAN",e[e.AI=9]="AI",e[e.TRADER=13]="TRADER",e[e.PIRATE=14]="PIRATE",e[e.NATIVE=11]="NATIVE"}(r||(t.PlayerKind=r={}))},kBLC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n("KTje"))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.loaded=!1}var t,n,r;return t=e,(n=[{key:"load",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,this.fs.openAndGetContentAsText("/fields.json");case 3:e.t1=e.sent,this.fieldConfig=e.t0.parse.call(e.t0,e.t1),this.loaded=!0;case 6:case"end":return e.stop()}},e,this)}))}},{key:"getFieldData",value:function(){for(var e=new Map,t=this.getFieldConfig(),n=Object.keys(t),r=0;r<n.length;r++){var a=n[r],o=parseInt(t[a].Id,10);e.set(o,new i.default(t[a]))}return e}},{key:"getFieldConfig",value:function(){if(!this.loaded)throw new Error("Configuration is not loaded. Call .load() first!");return this.fieldConfig.objects.HAUS.items}}])&&a(t.prototype,n),r&&a(t,r),e}();t.default=s},lXCB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!Boolean(e))throw new Error(t||"unknown assertion error")}},mgMI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n("lXCB"))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t,n,r,i,a,o,s,u,c,l,d,f,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.numNativesNorth=t,this.numNativesSouth=n,this.numBigIronOre=r,this.numSmallIronOre=i,this.numGoldOre=a,this.numWine=o,this.numSugarCane=s,this.numSpice=u,this.numCacao=c,this.numTobacco=l,this.numCotton=d,this.numTreasures=f,this.islandTemplates=h}var t,n,r;return t=e,r=[{key:"fromSaveGame",value:function(t){for(var n=t.slice(100),r=n[64],a=n[68],o=t.read32(),s=t.slice(268),u=s[46],c=s[54],l=s[62],d=s[110],f=s[95],h=s[86],p=s[118],m=s[78],v=s[102],g=s[174],y=[],b=0;b<o;b++){var w=t.read8(),x=0===w,k=1===w,S=t.read8();if(S<0||S>4)throw new Error("Invalid island size category: ".concat(S,"."));(0,i.default)(0===t.read8());var _=t.read8(),O=(t.read32(),new PIXI.Point(t.read32(),t.read32()));y.push({num:_,size:S,position:O,climate:x?"NORTH":k?"SOUTH":"ANY"})}var P=!0,I=!1,E=void 0;try{for(var R,A=t.slice(t.length-t.position())[Symbol.iterator]();!(P=(R=A.next()).done);P=!0){var j=R.value;(0,i.default)(0===j)}}catch(e){I=!0,E=e}finally{try{P||null==A.return||A.return()}finally{if(I)throw E}}return new e(r,a,u,c,l,d,f,h,p,m,v,g,y)}},{key:"empty",value:function(){return new e(0,0,0,0,0,0,0,0,0,0,0,0,[])}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.default=o},"n/3h":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OreLocation=t.OreLocationSize=t.OreLocationKind=void 0;var r,i,a,o=(r=n("lXCB"))&&r.__esModule?r:{default:r};function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.OreLocationKind=i,function(e){e[e.Iron=2]="Iron",e[e.Gold=3]="Gold"}(i||(t.OreLocationKind=i={})),t.OreLocationSize=a,function(e){e[e.Small=1]="Small",e[e.Big=0]="Big"}(a||(t.OreLocationSize=a={}));var u=function(){function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.kind=t,this.size=n,this.amount=r,this.position=i,this.discoveredBy=a}var t,n,r;return t=e,r=[{key:"fromSaveGame",value:function(t){var n=t.read8(),r=new PIXI.Point(t.read8(),t.read8()),i=t.read8(),a=t.read8();return(0,o.default)(0===t.read8()),new e(n,a,t.read16(),r,i)}}],(n=null)&&s(t.prototype,n),r&&s(t,r),e}();t.OreLocation=u},oroG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),i=n("xFL8");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.textures=new Map}var t,n,s;return t=e,(n=[{key:"getTextures",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e="/gfx/".concat(e),this.textures.has(e)){t.next=4;break}return t.next=4,this.loadTextures(e);case 4:return t.abrupt("return",this.textures.get(e));case 5:case"end":return t.stop()}},t,this)}))}},{key:"loadTextures",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,o,s,u,c,l,d,f=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Map,t.next=3,this.fs.ls(e);case 3:a=t.sent,o=!0,s=!1,u=void 0,t.prev=7,c=a[Symbol.iterator]();case 9:if(o=(l=c.next()).done){t.next=17;break}if(d=l.value,"png"!==d.name.substr(d.name.lastIndexOf(".")+1)){t.next=14;break}return t.delegateYield(regeneratorRuntime.mark(function e(){var t,a,o,s,u,c,l,h,p,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.fullPath.substring(0,d.fullPath.lastIndexOf("."))+".json",e.t0=JSON,e.next=4,f.fs.openAndGetContentAsText(t);case 4:return e.t1=e.sent,a=e.t0.parse.call(e.t0,e.t1),e.next=8,f.fs.openAndGetContentAsUint8Array(d);case 8:return o=e.sent,s=(0,i.textureFromUint8ArrayPNG)(o),u=new r.Spritesheet(s.baseTexture,a),e.next=13,new Promise(function(e,t){u.parse(function(t,n){e(t)})});case 13:for(c=e.sent,l=Object.keys(c),h=0;h<l.length;h++)p=l[h],m=c[p],n.set(parseInt(p,10),m);case 16:case"end":return e.stop()}},e,this)})(),"t0",14);case 14:o=!0,t.next=9;break;case 17:t.next=23;break;case 19:t.prev=19,t.t1=t.catch(7),s=!0,u=t.t1;case 23:t.prev=23,t.prev=24,o||null==c.return||c.return();case 26:if(t.prev=26,!s){t.next=29;break}throw u;case 29:return t.finish(26);case 30:return t.finish(23);case 31:this.textures.set(e,n);case 32:case"end":return t.stop()}},t,this,[[7,19,23,31],[24,,26,30]])}))}}])&&a(t.prototype,n),s&&a(t,s),e}();t.default=s},pF7d:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.soldierFromSaveGame=function(e){var t=new PIXI.Point(e.read16()/2,e.read16()/2),n=e.read16(),r=e.read16(),i=e.read16(),a=(e.read(4),e.read16(),e.read16(),e.read8(),e.read8(),e.read32(),e.read8()),o=(e.read8(),e.read8(),e.read8()),s=(e.read8(),e.read8Bool());e.read(4),e.read(4),e.read(30);return{id:i,playerId:a,type:r,position:t,rotation:o,isPatrolling:s,hp:n}},t.SoldierType=void 0,t.SoldierType=r,function(e){e[e.Swordsman=0]="Swordsman",e[e.Cavalry=1]="Cavalry",e[e.Musketeer=2]="Musketeer",e[e.Gunner=3]="Gunner",e[e.Native=8]="Native"}(r||(t.SoldierType=r={}))},q6wZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("fqKA")),i=a(n("lXCB"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fs=t,this.islandSizes=[{id:0,name:"lit",maxSize:35},{id:1,name:"mit",maxSize:45},{id:2,name:"med",maxSize:55},{id:3,name:"big",maxSize:85},{id:4,name:"lar",maxSize:100}]}var t,n,a;return t=e,(n=[{key:"loadIslandFile",value:function(e){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.isSouth?"south":"north",r=e.numBaseIsland.toString().padStart(2,"0"),i=!0,a=!1,o=void 0,t.prev=5,s=this.islandSizes[Symbol.iterator]();case 7:if(i=(u=s.next()).done){t.next=14;break}if(c=u.value,!(e.size.x<=c.maxSize)){t.next=11;break}return t.abrupt("return",this.fs.openAndGetContentAsStream("/islands/".concat(n,"/").concat(c.name).concat(r,".scp")));case 11:i=!0,t.next=7;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(5),a=!0,o=t.t0;case 20:t.prev=20,t.prev=21,i||null==s.return||s.return();case 23:if(t.prev=23,!a){t.next=26;break}throw o;case 26:return t.finish(23);case 27:return t.finish(20);case 28:throw new Error("Could not load island");case 29:case"end":return t.stop()}},t,this,[[5,16,20,28],[21,,23,27]])}))}},{key:"loadRandomIslandFile",value:function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=this.islandSizes.find(function(t){return t.id===e}))){n.next=3;break}throw new Error("This should never happen.");case 3:if(i=[],!["ANY","NORTH"].includes(t)){n.next=13;break}return n.t0=i.push,n.t1=i,n.t2=o,n.next=10,this.loadIslandsWithSizeAndClimate(r.name,"north");case 10:n.t3=n.sent,n.t4=(0,n.t2)(n.t3),n.t0.apply.call(n.t0,n.t1,n.t4);case 13:if(!["ANY","SOUTH"].includes(t)){n.next=22;break}return n.t5=i.push,n.t6=i,n.t7=o,n.next=19,this.loadIslandsWithSizeAndClimate(r.name,"south");case 19:n.t8=n.sent,n.t9=(0,n.t7)(n.t8),n.t5.apply.call(n.t5,n.t6,n.t9);case 22:return a=i[Math.floor(Math.random()*i.length)],n.next=25,this.fs.openAndGetContentAsStream(a.file.fullPath);case 25:return n.t10=n.sent,n.t11="south"===a.climate,n.t12=a.id,n.abrupt("return",{data:n.t10,isSouth:n.t11,id:n.t12});case 29:case"end":return n.stop()}},n,this)}))}},{key:"parseIslandBuildings",value:function(e,t){for(var n=t.data,a=t.length,o=[],s=0;s<e.size.x;s++)o.push(new Array(e.size.y).fill(null));for(var u=0;u<a/r.default.saveGameDataLength;u++){var c=r.default.fromSaveGame(n);(0,i.default)(c.x<e.size.x),(0,i.default)(c.y<e.size.y),o[c.x][c.y]=c}return o}},{key:"loadIslandsWithSizeAndClimate",value:function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.fs.ls("/islands/".concat(t));case 2:return n.t0=function(t){return t.name.startsWith(e)},n.t1=function(e){return null!==e.name.match(/\d\d\.scp$/)},n.t2=function(e){return{file:e,climate:t,id:parseInt(e.name.substr(3,2),10)}},n.abrupt("return",n.sent.filter(n.t0).filter(n.t1).map(n.t2));case 6:case"end":return n.stop()}},n,this)}))}}])&&s(t.prototype,n),a&&s(t,a),e}();t.default=c},tDmD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorsToIdx=t.default=void 0;var r=new Uint8Array([0,0,0,128,0,0,0,128,0,128,128,0,0,0,128,109,31,108,0,128,128,192,192,192,255,0,255,255,0,255,0,0,0,0,4,4,0,8,8,0,16,0,11,6,3,21,8,0,37,4,0,0,20,4,6,22,6,0,33,0,3,38,3,14,28,5,8,49,4,32,24,0,27,44,0,10,12,18,8,28,20,24,22,16,35,23,12,1,41,21,12,44,19,24,43,17,35,41,15,10,22,37,10,44,37,36,31,31,34,49,29,18,36,44,38,46,41,19,34,64,4,61,6,16,59,6,21,62,8,37,61,4,14,60,40,33,59,35,41,61,32,14,55,64,24,61,61,33,49,61,37,61,57,17,58,72,41,61,66,17,60,78,17,58,94,13,77,0,37,78,0,18,77,8,23,77,37,28,77,72,25,77,88,22,73,110,17,95,3,37,98,0,22,93,61,22,112,45,21,150,36,25,124,107,28,148,113,0,82,140,8,74,144,248,194,48,8,82,148,8,86,148,12,78,140,23,82,136,0,99,140,24,94,140,8,90,156,12,90,160,18,99,148,18,101,148,10,117,150,8,90,173,8,99,169,12,103,165,21,104,165,6,121,173,19,115,171,33,115,165,10,118,181,24,119,177,33,115,173,33,123,177,24,117,187,8,136,189,11,136,196,17,136,220,33,156,132,0,156,148,24,156,177,0,156,214,12,148,206,196,120,94,11,173,216,8,148,231,8,148,239,12,160,230,28,152,226,21,178,225,16,177,239,24,189,231,33,189,222,0,148,247,80,150,226,0,156,255,224,138,108,242,153,122,233,113,2,255,125,2,8,165,247,251,216,52,244,175,45,16,156,247,24,148,239,20,152,251,255,252,157,33,165,247,54,17,4,74,17,4,53,45,12,70,44,11,60,74,11,41,99,0,59,90,19,45,103,0,46,112,0,45,99,8,44,106,17,55,109,2,55,106,17,66,106,3,68,108,16,59,47,38,62,68,41,59,61,64,61,74,63,60,97,45,65,91,68,63,77,75,60,99,75,49,76,90,63,75,85,46,98,90,65,101,86,58,95,104,55,98,117,55,102,140,94,22,5,89,42,20,90,64,26,89,96,11,90,94,45,88,80,70,87,102,68,89,79,80,85,103,80,93,107,77,90,88,89,86,111,90,87,99,98,88,102,117,115,33,10,113,65,20,111,95,17,111,82,57,108,111,65,111,107,90,107,104,107,143,29,4,137,86,13,140,88,31,137,99,64,172,39,5,166,93,37,197,49,8,205,84,30,41,126,2,49,123,0,53,127,0,66,123,0,52,123,11,54,123,20,54,122,73,49,132,4,66,132,0,49,132,20,64,132,22,53,140,0,53,134,55,49,141,50,49,167,29,83,130,9,91,126,62,87,121,107,108,123,103,82,171,6,85,145,47,89,182,41,119,126,60,119,119,105,116,180,48,170,128,42,145,125,103,133,187,58,202,172,52,43,133,116,83,127,115,127,124,115,125,142,115,74,126,126,73,128,164,118,132,123,118,135,143,43,160,124,95,156,132,45,181,136,63,193,138,92,169,189,63,222,167,86,237,200,144,137,123,141,153,133,152,149,127,175,154,124,152,165,140,152,178,141,169,176,140,204,194,133,154,176,173,185,182,160,179,200,167,172,209,207,221,218,181,225,239,226,254,250,230,0,148,255,160,160,164,128,128,128,255,0,0,0,255,0,255,255,0,0,0,255,255,0,255,0,255,255,255,255,255]),i=r;t.default=i;for(var a={},o=0;o<r.length/3;o++){a[((r[3*o+0]<<24)+(r[3*o+1]<<16)+(r[3*o+2]<<8)+255).toString()]=o}var s=a;t.colorsToIdx=s},tTUl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.taskFromSaveGame=function(e){var t=e.read32(),n=e.read(28),r=e.read8();(0,i.default)(0===e.read8());var a=e.read8();(0,i.default)(0===e.read8());var o=e.read8();(0,i.default)(e.read(6).every(function(e){return 0===e}));var s=[];e.read8Bool()&&s.push("any");e.read8Bool()&&s.push("red");e.read8Bool()&&s.push("blue");e.read8Bool()&&s.push("yellow");e.read8Bool()&&s.push("white");e.read8Bool()&&s.push("trader");e.read8Bool()&&s.push("pirate");e.read8Bool()&&s.push("native");for(var u=e.read(25),c=e.read32(),l=e.read32(),d=e.read32(),f=e.read(16),h=e.readString(2048),p=e.read(8),m=[],v=0;v<3;v++)m.push({count:e.read32(),requiredLevel:e.read32(),requiredLevelCount:e.read32()});var g=e.read(36),y={count:e.read32(),requiredLevel:e.read32(),requiredLevelCount:e.read32()};return console.warn("task",t,n,u,f,p,g),{id:t,text:h,successVideoId:l,playersToKill:s,requiredBalance:c,requiredTradeBalance:d,ownCityReachInhabitants:m,helpOtherToReachInhabitantsPlayerId:o,helpOtherToReachInhabitants:y,monopolyGoodId1:r,monopolyGoodId2:a}};var r,i=(r=n("lXCB"))&&r.__esModule?r:{default:r}},tyYu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n("Ny9C"))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adpcmIndexTable=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],this.adpcmStepTable=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767]}var t,n,r;return t=e,(n=[{key:"decode",value:function(e){var t=new i.default(e),n=t.fmt.bitsPerSample,r=t.fmt.sampleRate,a=t.fmt.numChannels;if(4!==n)throw new Error("Can only convert .wav files with 4 bits per sample.");if(2!==a)throw new Error("Can only convert .wav files with stereo sound.");for(var o={step_index:0,predictor:0},s={step_index:0,predictor:0},u=t.data.samples,c=new Int16Array(u.length),l=new Int16Array(u.length),d=0;d<u.length;d++)c[d]=this.decodeADPCM_IMA(o,u[d]>>>4),l[d]=this.decodeADPCM_IMA(s,15&u[d]);return{left:c,right:l,sampleRate:r}}},{key:"encode",value:function(e){for(var t=e.left.length,n=new Int16Array(2*t),r=0;r<t;r++)n[2*r+0]=e.left[r],n[2*r+1]=e.right[r];var a=new i.default;return a.fromScratch(2,e.sampleRate,"16",n),a.toBuffer()}},{key:"av_clip",value:function(e,t,n){return Math.min(Math.max(t,e),n)}},{key:"av_clip_int16",value:function(e){return e+32768&-65536?e>>31^32767:e}},{key:"decodeADPCM_IMA",value:function(e,t){var n=this.adpcmStepTable[e.step_index],r=this.av_clip(e.step_index+this.adpcmIndexTable[t],0,88),i=8&t,a=(2*(7&t)+1)*n>>>3,o=e.predictor;return i?o-=a:o+=a,e.predictor=this.av_clip_int16(o),e.step_index=r,e.predictor}}])&&a(t.prototype,n),r&&a(t,r),e}();t.default=o},vR12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shipFromSaveGame=function(e){var t=e.readString(28),n=new PIXI.Point(e.read16(),e.read16()),a=(e.read(12),r.ShipCourse.fromSaveGame(e),r.ShipCourse.fromSaveGame(e),r.ShipCourse.fromSaveGame(e),e.read32(),e.read16()),o=(e.read32(),e.read8(),e.read8(),e.read16(),e.read16()),s=(e.read16(),e.read8(),e.read8()),u=(e.read32(),e.read16()),c=function(e,t){for(var n=[],r=0;r<t;r++)n.push({id:e.read8(),kontor_id:e.read8(),_1:e.read16(),goods:i(e,2),_2:e.read(16)});return n}(e,8),l=(e.read16(),i(e,8));return{id:o,playerId:s,position:n,rotation:u,name:t,hp:a,tradeStops:c,cargo:l}};var r=n("bmue");function i(e,t){for(var n=[],r=0;r<t;r++)n.push({good_id:e.read16(),amount:e.read16(),action:e.read32()});return n}},vqtW:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GoodAction=void 0,t.GoodAction=i,function(e){e[e.None=0]="None",e[e.Sell=1]="Sell",e[e.Buy=2]="Buy"}(i||(t.GoodAction=i={}));var a=function(){function e(t,n,r,i,a,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.goodId=t,this.sellingPrice=n,this.buyingPrice=r,this.wantedSellingAmount=i,this.wantedBuyingAmount=a,this.currentAmount=o,this.action=s}var t,n,i;return t=e,i=[{key:"fromSaveGame",value:function(t){var n=t.read32(),r=(1023&n)>>0,i=(1047552&n)>>10,a=(4293918720&n)>>20,o=(t.read32(),t.read16()>>5),s=t.read16()>>5,u=t.read16()>>5,c=(t.read16(),t.read16());t.read16();return new e(c,r,i,o,s,u,a)}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.default=a},vurl:function(module,exports,__webpack_require__){"use strict";function uInt8ToBase64(arr){for(var CHUNK_SIZE=32768,index=0,length=arr.length,result="";index<length;){var slice=arr.subarray(index,Math.min(index+CHUNK_SIZE,length));result+=String.fromCharCode.apply(null,slice),index+=CHUNK_SIZE}return"undefined"!=typeof window?btoa(result):eval("require")("btoa")(result)}function getQueryParameter(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function findRootInZip(e){var t=e.filter(function(e){return("/"+e).endsWith("/GFX/")});if(1===t.length)return e.folder(t[0].name.replace("GFX/",""));throw new Error("Your ZIP file does not have the expected structure.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.uInt8ToBase64=uInt8ToBase64,exports.getQueryParameter=getQueryParameter,exports.findRootInZip=findRootInZip},xFL8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textureFromUint8ArrayPNG=function(e){return r.Texture.fromImage("data:image/png;base64,".concat((0,i.uInt8ToBase64)(e)))},t.textureFromUint8ArrayMP4=function(e){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(n=document.createElement("video")).src="data:video/mp4;base64,".concat((0,i.uInt8ToBase64)(e)),a=r.VideoBaseTexture.fromVideo(n),t.abrupt("return",new Promise(function(e,t){a.on("loaded",function(){return e(a)}),a.on("error",t)}));case 4:case"end":return t.stop()}},t,this)}))};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n("kSzJ")),i=n("vurl");var a=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}},ynKt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n={},r=!0,i=!1,a=void 0;try{for(var o,s=e.split("\r\n")[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;t?"[END]"===u?t=null:n[t].push(u):u.startsWith("[")&&(t=u.split(/[[\]]/)[1],n[t]=[])}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}},[[4,0,1]]]);
//# sourceMappingURL=app.5a9123fd51a95051b7a0.js.map